<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Referrer Policy</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 9e4e5f0f6, updated Mon Oct 28 14:51:59 2024 -0700" name="generator">
  <link href="http://www.w3.org/TR/referrer-policy/" rel="canonical">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-mdn-anno */
:root {
	--mdn-bg: #EEE;
	--mdn-shadow: #999;
	--mdn-nosupport-text: #ccc;
	--mdn-pass: green;
	--mdn-fail: red;
}
@media (prefers-color-scheme: dark) {
	:root {
		--mdn-bg: #222;
		--mdn-shadow: #444;
		--mdn-nosupport-text: #666;
		--mdn-pass: #690;
		--mdn-fail: #d22;
	}
}
.mdn-anno {
	background: var(--mdn-bg, #EEE);
	border-radius: .25em;
	box-shadow: 0 0 3px var(--mdn-shadow, #999);
	color: var(--text, black);
	font: 1em sans-serif;
	hyphens: none;
	max-width: min-content;
	overflow: hidden;
	padding: 0.2em;
	position: absolute;
	right: 0.3em;
	top: auto;
	white-space: nowrap;
	word-wrap: normal;
	z-index: 8;
}
.mdn-anno.unpositioned {
	display: none;
}
.mdn-anno.overlapping-main {
	opacity: .2;
	transition: opacity .1s;
}
.mdn-anno[open] {
	opacity: 1;
	z-index: 9;
	min-width: 9em;
}
.mdn-anno:hover {
	opacity: 1;
	outline: var(--text, black) 1px solid;
}
.mdn-anno > summary {
	font-weight: normal;
	text-align: right;
	cursor: pointer;
	display: block;
}
.mdn-anno > summary > .less-than-two-engines-flag {
	color: var(--mdn-fail);
	padding-right: 2px;
}
.mdn-anno > summary > .all-engines-flag {
	color: var(--mdn-pass);
	padding-right: 2px;
}
.mdn-anno > summary > span {
	color: #fff;
	background-color: #000;
	font-weight: normal;
	font-family: zillaslab, Palatino, "Palatino Linotype", serif;
	padding: 2px 3px 0px 3px;
	line-height: 1.3em;
	vertical-align: top;
}
.mdn-anno > .feature {
	margin-top: 20px;
}
.mdn-anno > .feature:not(:first-of-type) {
	border-top: 1px solid #999;
	margin-top: 6px;
	padding-top: 2px;
}
.mdn-anno > .feature > .less-than-two-engines-text {
	color: var(--mdn-fail);
}
.mdn-anno > .feature > .all-engines-text {
	color: var(--mdn-pass);
}
.mdn-anno > .feature > p {
	font-size: .75em;
	margin-top: 6px;
	margin-bottom: 0;
}
.mdn-anno > .feature > p + p {
	margin-top: 3px;
}
.mdn-anno > .feature > .support {
	display: block;
	font-size: 0.6em;
	margin: 0;
	padding: 0;
	margin-top: 2px;
}
.mdn-anno > .feature > .support + div {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > hr {
	display: block;
	border: none;
	border-top: 1px dotted #999;
	padding: 3px 0px 0px 0px;
	margin: 2px 3px 0px 3px;
}
.mdn-anno > .feature > .support > hr::before {
	content: "";
}
.mdn-anno > .feature > .support > span {
	padding: 0.2em 0;
	display: block;
	display: table;
}
.mdn-anno > .feature > .support > span.no {
	color: var(--mdn-nosupport-text);
	filter: grayscale(100%);
}
.mdn-anno > .feature > .support > span.no::before {
	opacity: 0.5;
}
.mdn-anno > .feature > .support > span:first-of-type {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > span > span {
	padding: 0 0.5em;
	display: table-cell;
}
.mdn-anno > .feature > .support > span > span:first-child {
	width: 100%;
}
.mdn-anno > .feature > .support > span > span:last-child {
	width: 100%;
	white-space: pre;
	padding: 0;
}
.mdn-anno > .feature > .support > span::before {
	content: ' ';
	display: table-cell;
	min-width: 1.5em;
	height: 1.5em;
	background: no-repeat center center;
	background-size: contain;
	text-align: right;
	font-size: 0.75em;
	font-weight: bold;
}
.mdn-anno > .feature > .support > .chrome_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .firefox_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .chrome::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .edge_blink::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
}
.mdn-anno > .feature > .support > .edge::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
}
.mdn-anno > .feature > .support > .firefox::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .ie::before {
	background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
}
.mdn-anno > .feature > .support > .safari_ios::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
}
.mdn-anno > .feature > .support > .nodejs::before {
	background-image: url(https://nodejs.org/static/images/favicons/favicon.ico);
}
.mdn-anno > .feature > .support > .opera_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .opera::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .safari::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
}
.mdn-anno > .feature > .support > .samsunginternet_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
}
.mdn-anno > .feature > .support > .webview_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
}
.name-slug-mismatch {
	color: red;
}
.caniuse-status:hover {
	z-index: 9;
}
/* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */;
.h-entry:not(.status-LS) dt > .mdn-anno, .h-entry:not(.status-LS) li > .mdn-anno, .h-entry:not(.status-LS) .issue > .mdn-anno, .h-entry:not(.status-LS) .note > .mdn-anno, .h-entry:not(.status-LS) .example > .mdn-anno {
	right: -6.7em;
}
.h-entry p + .mdn-anno {
	margin-top: 0;
}
 h2 + .mdn-anno.after {
	margin: -48px 0 0 0;
}
 h3 + .mdn-anno.after {
	margin: -46px 0 0 0;
}
 h4 + .mdn-anno.after {
	margin: -42px 0 0 0;
}
 h5 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
 h6 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1>Referrer Policy</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="2024-11-01">1 November 2024</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/webappsec-referrer-policy/">https://w3c.github.io/webappsec-referrer-policy/</a>
      <dt>Latest published version:
      <dd><a href="http://www.w3.org/TR/referrer-policy/">http://www.w3.org/TR/referrer-policy/</a>
      <dt>Version History:
      <dd><a href="https://github.com/w3c/webappsec-referrer-policy/commits/main/index.src.html">https://github.com/w3c/webappsec-referrer-policy/commits/main/index.src.html</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BREFERRER-POLICY%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[REFERRER-POLICY] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
      <dd><a href="https://github.com/w3c/webappsec-referrer-policy/issues/">GitHub</a>
      <dd><a href="#issues-index">Inline In Spec</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard" data-editor-id="102763"><a class="p-name fn u-email email" href="mailto:domfarolino@gmail.com">Dominic Farolino</a> (<span class="p-org org">Google Inc.</span>)
      <dt class="editor">Former Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="76989"><a class="p-name fn u-email email" href="mailto:estark@google.com">Emily Stark</a> (<span class="p-org org">Google Inc.</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="49402"><a class="p-name fn u-email email" href="mailto:eisinger@google.com">Jochen Eisinger</a> (<span class="p-org org">Google Inc.</span>)
      <dt>Tests:
      <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/referrer-policy">web-platform-tests referrer-policy/</a> (<a href="https://github.com/web-platform-tests/wpt/labels/referrer-policy">ongoing work</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2024 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document describes how an author can set a referrer policy for documents they create, and the impact of such a policy on the <code>Referer</code> HTTP header for outgoing requests and navigations.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> <strong>Changes to this document may be tracked at <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong> </p>
   <p> The (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5BREFERRER-POLICY%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="https://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “REFERRER-POLICY” in the subject,
	preferably like this:
	“[REFERRER-POLICY] <em>…summary of comment…</em>” </p>
   <p> This document was produced by the <a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/policies/patent-policy/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/groups/wg/webappsec/ipr" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#intro-privacy"><span class="secno">1.1</span> <span class="content">Privacy</span></a>
      <li><a href="#intro-security"><span class="secno">1.2</span> <span class="content">Security</span></a>
      <li><a href="#intro-trackback"><span class="secno">1.3</span> <span class="content">Trackback</span></a>
     </ol>
    <li><a href="#terms"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
    <li>
     <a href="#referrer-policies"><span class="secno">3</span> <span class="content">Referrer Policies</span></a>
     <ol class="toc">
      <li><a href="#referrer-policy-no-referrer"><span class="secno">3.1</span> <span class="content">"<code>no-referrer</code>"</span></a>
      <li><a href="#referrer-policy-no-referrer-when-downgrade"><span class="secno">3.2</span> <span class="content">"<code>no-referrer-when-downgrade</code>"</span></a>
      <li><a href="#referrer-policy-same-origin"><span class="secno">3.3</span> <span class="content">"<code>same-origin</code>"</span></a>
      <li><a href="#referrer-policy-origin"><span class="secno">3.4</span> <span class="content">"<code>origin</code>"</span></a>
      <li><a href="#referrer-policy-strict-origin"><span class="secno">3.5</span> <span class="content">"<code>strict-origin</code>"</span></a>
      <li><a href="#referrer-policy-origin-when-cross-origin"><span class="secno">3.6</span> <span class="content">"<code>origin-when-cross-origin</code>"</span></a>
      <li><a href="#referrer-policy-strict-origin-when-cross-origin"><span class="secno">3.7</span> <span class="content">"<code>strict-origin-when-cross-origin</code>"</span></a>
      <li><a href="#referrer-policy-unsafe-url"><span class="secno">3.8</span> <span class="content">"<code>unsafe-url</code>"</span></a>
      <li><a href="#referrer-policy-empty-string"><span class="secno">3.9</span> <span class="content">The empty string</span></a>
     </ol>
    <li>
     <a href="#referrer-policy-delivery"><span class="secno">4</span> <span class="content">Referrer Policy Delivery</span></a>
     <ol class="toc">
      <li>
       <a href="#referrer-policy-header"><span class="secno">4.1</span> <span class="content">Delivery via Referrer-Policy header</span></a>
       <ol class="toc">
        <li><a href="#referrer-usage"><span class="secno">4.1.1</span> <span class="content">Usage</span></a>
       </ol>
      <li><a href="#referrer-policy-delivery-meta"><span class="secno">4.2</span> <span class="content">Delivery via <code><span>meta</span></code></span></a>
      <li><a href="#referrer-policy-delivery-referrer-attribute"><span class="secno">4.3</span> <span class="content">Delivery
    via a <code>referrerpolicy</code> content attribute</span></a>
      <li><a href="#referrer-policy-inheritance"><span class="secno">4.4</span> <span class="content"><span>Referrer Policy</span> Inheritance</span></a>
     </ol>
    <li><a href="#integration-with-fetch"><span class="secno">5</span> <span class="content">Integration with Fetch</span></a>
    <li><a href="#integration-with-html"><span class="secno">6</span> <span class="content">Integration with HTML</span></a>
    <li><a href="#integration-with-css"><span class="secno">7</span> <span class="content">Integration with CSS</span></a>
    <li>
     <a href="#algorithms"><span class="secno">8</span> <span class="content">Algorithms</span></a>
     <ol class="toc">
      <li><a href="#parse-referrer-policy-from-header"><span class="secno">8.1</span> <span class="content"> Parse a referrer policy from a <span><code>Referrer-Policy</code></span> header </span></a>
      <li><a href="#set-requests-referrer-policy-on-redirect"><span class="secno">8.2</span> <span class="content"> Set <var>request</var>’s referrer policy on redirect </span></a>
      <li><a href="#determine-requests-referrer"><span class="secno">8.3</span> <span class="content"> Determine <var>request</var>’s Referrer </span></a>
      <li><a href="#strip-url"><span class="secno">8.4</span> <span class="content"> Strip <var>url</var> for use as a referrer </span></a>
     </ol>
    <li>
     <a href="#privacy"><span class="secno">9</span> <span class="content">Privacy Considerations</span></a>
     <ol class="toc">
      <li><a href="#user-controls"><span class="secno">9.1</span> <span class="content">User Controls</span></a>
     </ol>
    <li>
     <a href="#security"><span class="secno">10</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#information-leakage"><span class="secno">10.1</span> <span class="content">Information Leakage</span></a>
      <li><a href="#downgrade"><span class="secno">10.2</span> <span class="content">Downgrade to less strict policies</span></a>
     </ol>
    <li>
     <a href="#authoring"><span class="secno">11</span> <span class="content">Authoring Considerations</span></a>
     <ol class="toc">
      <li><a href="#unknown-policy-values"><span class="secno">11.1</span> <span class="content">Unknown Policy Values</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">12</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>Requests made from a document, and for navigations away from that document
  are associated with a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3"><code>Referer</code></a> header. While the header
  can be suppressed for links with the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#link-type-noreferrer" id="ref-for-link-type-noreferrer"><code>noreferrer</code></a> link
  type, authors might wish to control the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①"><code>Referer</code></a> header
  more directly for a number of reasons:</p>
    <h3 class="heading settled" data-level="1.1" id="intro-privacy"><span class="secno">1.1. </span><span class="content">Privacy</span><a class="self-link" href="#intro-privacy"></a></h3>
    <p>A social networking site has a profile page for each of its users, and users
  add hyperlinks from their profile page to their favorite bands. The social
  networking site might not wish to leak the user’s profile URL to the band web
  sites when other users follow those hyperlinks (because the profile URLs might
  reveal the identity of the owner of the profile).</p>
    <p>Some social networking sites, however, might wish to inform the band web sites
  that the links originated from the social networking site but not reveal which
  specific user’s profile contained the links.</p>
    <h3 class="heading settled" data-level="1.2" id="intro-security"><span class="secno">1.2. </span><span class="content">Security</span><a class="self-link" href="#intro-security"></a></h3>
    <p>A web application uses HTTPS and a URL-based session identifier. The web
  application might wish to link to HTTPS resources on other web sites without
  leaking the user’s session identifier in the URL.</p>
    <p>Alternatively, a web application may use URLs which themselves grant some
  capability. Controlling the referrer can help prevent these capability URLs
  from leaking via referrer headers. <a data-link-type="biblio" href="#biblio-capability-urls" title="Good Practices for Capability URLs">[CAPABILITY-URLS]</a></p>
    <p>Note that there are other ways for capability URLs to leak, and controlling
  the referrer is not enough to control all those potential leaks.</p>
    <h3 class="heading settled" data-level="1.3" id="intro-trackback"><span class="secno">1.3. </span><span class="content">Trackback</span><a class="self-link" href="#intro-trackback"></a></h3>
    <p>A blog hosted over HTTPS might wish to link to a blog hosted over HTTP and
  receive trackback links.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="terms"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#terms"></a></h2>
    <dl>
     <dt> <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy">referrer policy</a> 
     <dd>
       A <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy①">referrer policy</a> modifies the algorithm used to populate the <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②"><code>Referer</code></a> header when <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">fetching</a> subresources,
      prefetching, or performing navigations. This document defines the various
      behaviors for each <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy②">referrer policy</a>. 
      <p>Every <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> has an algorithm for obtaining a <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy③">referrer policy</a>, which is used by default for all <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">requests</a> with that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①">environment settings object</a> as their <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client">client</a>.</p>
     <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="same-origin-referrer-request">same-origin-referrer request</dfn>
     <dd> A <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request">Request</a></code> <var>request</var> is a <strong>same-origin-referrer request</strong> if the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a> of <var>request</var>’s <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl">referrerURL</a> and the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origin</a> of <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url">current URL</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin">the same</a>. 
     <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="cross-origin-referrer-request">cross-origin-referrer request</dfn>
     <dd> A <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request①">Request</a></code> is a <strong>cross-origin-referrer request</strong> if it is <em>not</em> a <a data-link-type="dfn" href="#same-origin-referrer-request" id="ref-for-same-origin-referrer-request">same-origin-referrer request</a>. 
    </dl>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="referrer-policies"><span class="secno">3. </span><span class="content">Referrer Policies</span><span id="referrer-policy-states"></span><a class="self-link" href="#referrer-policies"></a></h2>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="referrer-policy">referrer policy</dfn> is the empty string, "<code>no-referrer</code>",
  "<code>no-referrer-when-downgrade</code>", "<code>same-origin</code>",
  "<code>origin</code>", "<code>strict-origin</code>",
  "<code>origin-when-cross-origin</code>",
  "<code>strict-origin-when-cross-origin</code>", or
  "<code>unsafe-url</code>".</p>
<pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-referrerpolicy"><code><c- g>ReferrerPolicy</c-></code></dfn> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy"><code><c- s>""</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-no-referrer"><code><c- s>"no-referrer"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-no-referrer-when-downgrade"><code><c- s>"no-referrer-when-downgrade"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-same-origin"><code><c- s>"same-origin"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-origin"><code><c- s>"origin"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-strict-origin"><code><c- s>"strict-origin"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-origin-when-cross-origin"><code><c- s>"origin-when-cross-origin"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-strict-origin-when-cross-origin"><code><c- s>"strict-origin-when-cross-origin"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="ReferrerPolicy" data-dfn-type="enum-value" data-export id="dom-referrerpolicy-unsafe-url"><code><c- s>"unsafe-url"</c-></code></dfn>
};
</pre>
    <p>Each possible <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy④">referrer policy</a> is explained below. A detailed
  algorithm for evaluating their effect is given in the <a href="#integration-with-fetch">§ 5 Integration with Fetch</a> and <a href="#algorithms">§ 8 Algorithms</a> sections.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The referrer policy for an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object②">environment settings object</a> provides a
  default baseline policy for requests when that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object③">environment settings
  object</a> is used as a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①">request client</a>. This policy may be tightened
  for specific requests via mechanisms like the <code><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#link-type-noreferrer" id="ref-for-link-type-noreferrer①">noreferrer</a></code> link type.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="default-referrer-policy">default referrer policy</dfn> is <a data-link-type="dfn" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin">"<code>strict-origin-when-cross-origin</code>"</a>.</p>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.1" data-lt="&quot;no-referrer&quot;" id="referrer-policy-no-referrer"><span class="secno">3.1. </span><span class="content">"<code>no-referrer</code>"</span><span id="referrer-policy-state-no-referrer"></span><a class="self-link" href="#referrer-policy-no-referrer" id="ref-for-referrer-policy-no-referrer"></a></h3>
    <p>The simplest policy is <a data-link-type="dfn" href="#referrer-policy-no-referrer" id="ref-for-referrer-policy-no-referrer⑤">"<code>no-referrer</code>"</a>, which specifies
  that no referrer information is to be sent along with requests to any <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin">origin</a>. The header <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3③"><code>Referer</code></a> will be omitted entirely.</p>
    <div class="example" id="example-13e0f89b"><a class="self-link" href="#example-13e0f89b"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-no-referrer" id="ref-for-referrer-policy-no-referrer①">"<code>no-referrer</code>"</a>, then navigations to <code>https://example.com/</code> (or any other URL) would send no <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3④"><code>Referer</code></a> header. </div>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.2" data-lt="&quot;no-referrer-when-downgrade&quot;" id="referrer-policy-no-referrer-when-downgrade"><span class="secno">3.2. </span><span class="content">"<code>no-referrer-when-downgrade</code>"</span><span id="referrer-policy-state-no-referrer-when-downgrade"></span><a class="self-link" href="#referrer-policy-no-referrer-when-downgrade" id="ref-for-referrer-policy-no-referrer-when-downgrade"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy-no-referrer-when-downgrade" id="ref-for-referrer-policy-no-referrer-when-downgrade④">"<code>no-referrer-when-downgrade</code>"</a> policy sends a request’s full <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①">referrerURL</a> <a href="#strip-url">stripped for use as a referrer</a> for requests:</p>
    <ul>
     <li>whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②">referrerURL</a> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①">current URL</a> are both <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url">potentially
      trustworthy URLs</a>, or
     <li>whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl③">referrerURL</a> is a non-<a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①">potentially trustworthy URL</a>.
    </ul>
    <p>Requests whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl④">referrerURL</a> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url②">potentially trustworthy URL</a> and whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url②">current URL</a> is a non-<a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url③">potentially trustworthy URL</a> on the other hand, will
  contain no referrer information. A <code><a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3⑤">Referer</a></code> HTTP header will not be sent.</p>
    <div class="example" id="example-8ec274c6">
     <a class="self-link" href="#example-8ec274c6"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-no-referrer-when-downgrade" id="ref-for-referrer-policy-no-referrer-when-downgrade①">"<code>no-referrer-when-downgrade</code>"</a>, then navigations to <code>https://not.example.com/</code> would send a <code><a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3⑥">Referer</a></code> HTTP header with a value of <code>https://example.com/page.html</code>, as neither resource’s origin is a
    non-<a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url④">potentially trustworthy URL</a>. 
     <p>Navigations from that same page to <code><strong>http</strong>://not.example.com/</code> would send no <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3⑦"><code>Referer</code></a> header.</p>
    </div>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.3" data-lt="&quot;same-origin&quot;" id="referrer-policy-same-origin"><span class="secno">3.3. </span><span class="content">"<code>same-origin</code>"</span><a class="self-link" href="#referrer-policy-same-origin" id="ref-for-referrer-policy-same-origin"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy-same-origin" id="ref-for-referrer-policy-same-origin⑤">"<code>same-origin</code>"</a> policy specifies that a request’s full <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl⑤">referrerURL</a> is
  sent as referrer information when making <a data-link-type="dfn" href="#same-origin-referrer-request" id="ref-for-same-origin-referrer-request①">same-origin-referrer requests</a>.</p>
    <p><a data-link-type="dfn" href="#cross-origin-referrer-request" id="ref-for-cross-origin-referrer-request">Cross-origin-referrer requests</a>, on the other hand, will contain no
  referrer information. A <code><a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3⑧">Referer</a></code> HTTP header will not be
  sent.</p>
    <div class="example" id="example-44f75544">
     <a class="self-link" href="#example-44f75544"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-same-origin" id="ref-for-referrer-policy-same-origin①">"<code>same-origin</code>"</a>, then navigations to <code>https://example.com/not-page.html</code> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3⑨"><code>Referer</code></a> header with a value of <code>https://example.com/page.html</code>. 
     <p>Navigations from that same page to <code>https://<strong>not</strong>.example.com/</code> would send no <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①⓪"><code>Referer</code></a> header.</p>
    </div>
    <div class="example" id="example-3fe4937f">
     <a class="self-link" href="#example-3fe4937f"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-same-origin" id="ref-for-referrer-policy-same-origin②">"<code>same-origin</code>"</a>, and fetches a module script at <code>https://script.example.com</code>, which then fetches a descendant script
    at <code>https://example.com/descendant.js</code>, the request for the descendant
    script would send no <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①①"><code>Referer</code></a> header. 
     <p>This is because the descendant script request’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url③">current URL</a> is <code>https://example.com/descendant.js</code>, while its <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl⑥">referrerURL</a> is <code>https://script.example.com</code>, making the request <a data-link-type="dfn" href="#cross-origin-referrer-request" id="ref-for-cross-origin-referrer-request①">cross-origin-referrer</a>.</p>
    </div>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.4" data-lt="&quot;origin&quot;" id="referrer-policy-origin"><span class="secno">3.4. </span><span class="content">"<code>origin</code>"</span><span id="referrer-policy-state-origin"></span><a class="self-link" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin⑨">"<code>origin</code>"</a> policy specifies that only the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin" id="ref-for-ascii-serialisation-of-an-origin">ASCII serialization</a> of the request’s <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl⑦">referrerURL</a> is sent as referrer information when making both <a data-link-type="dfn" href="#same-origin-referrer-request" id="ref-for-same-origin-referrer-request②">same-origin-referrer
  requests</a> and <a data-link-type="dfn" href="#cross-origin-referrer-request" id="ref-for-cross-origin-referrer-request②">cross-origin-referrer requests</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The serialization of an origin looks like <code>https://example.com</code>.
  To ensure that a valid URL is sent in the `<code>Referer</code>` header, user
  agents will append a U+002F SOLIDUS ("<code>/</code>") character to the origin
  (e.g. <code>https://example.com/</code>).</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin①">"<code>origin</code>"</a> policy allows the origin of HTTPS
  referrers to be sent over the network as part of unencrypted HTTP requests.
  The <a data-link-type="dfn" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin">"<code>strict-origin</code>"</a> policy addresses this concern.</p>
    <div class="example" id="example-5d156f10"><a class="self-link" href="#example-5d156f10"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin②">"<code>origin</code>"</a>, then navigations to any <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin①">origin</a> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①②"><code>Referer</code></a> header with a value
    of <code>https://example.com/</code>, even to URLs that are not <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url⑤">potentially trustworthy URL</a>. </div>
    <div class="example" id="example-8bfba7ab"><a class="self-link" href="#example-8bfba7ab"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin③">"<code>origin</code>"</a>, and fetches a module script at <code>https://script.example.com</code>, which fetches a descendant script at <code>https://descendant.example.com</code>, the request for the descendant script
    will send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①③"><code>Referer</code></a> header with a value of <code>https://script.example.com/</code>. </div>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.5" data-lt="&quot;strict-origin&quot;" id="referrer-policy-strict-origin"><span class="secno">3.5. </span><span class="content">"<code>strict-origin</code>"</span><a class="self-link" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin⑦"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin①">"<code>strict-origin</code>"</a> policy sends the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin" id="ref-for-ascii-serialisation-of-an-origin①">ASCII serialization</a> of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin②">origin</a> of the <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl⑧">referrerURL</a> for requests:</p>
    <ul>
     <li>whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl⑨">referrerURL</a> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url④">current URL</a> are both <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url⑥">potentially
      trustworthy URLs</a>, or
     <li>whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①⓪">referrerURL</a> is a non-<a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url⑦">potentially trustworthy URL</a>.
    </ul>
    <p>Requests whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①①">referrerURL</a> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url⑧">potentially trustworthy URL</a> and whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url⑤">current URL</a> is a non-<a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url⑨">potentially trustworthy URL</a> on the other hand, will
  contain no referrer information. A <code><a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①④">Referer</a></code> HTTP header will not be sent.</p>
    <div class="example" id="example-108b15a6">
     <a class="self-link" href="#example-108b15a6"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin②">"<code>strict-origin</code>"</a>, then navigations to <code>https://<strong>not</strong>.example.com</code> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①⑤"><code>Referer</code></a> header with a value of <code>https://example.com/</code>. 
     <p>Navigations from that same page to <code><strong>http://</strong>not.example.com</code> would send no <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①⑥"><code>Referer</code></a> header.</p>
    </div>
    <div class="example" id="example-d8f9ca3f"><a class="self-link" href="#example-d8f9ca3f"></a> If a document at <code>http://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin③">"<code>strict-origin</code>"</a>, then navigations to <code>http://<strong>not</strong>.example.com</code> or <code><strong>https</strong>://example.com</code> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①⑦"><code>Referer</code></a> header with a value of <code>http://example.com/</code>. </div>
    <div class="example" id="example-fc40d708"><a class="self-link" href="#example-fc40d708"></a> If a document at <code>http://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin④">"<code>strict-origin</code>"</a>, and fetches a module script at <code><strong>https</strong>://script.example.com</code>, which then fetches a
    descendant script at <code><strong>http</strong>://descendant.example.com</code>,
    the request to the descendant script would not send a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#meta-referrer" id="ref-for-meta-referrer"><code>Referrer</code></a> header. </div>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.6" data-lt="&quot;origin-when-cross-origin&quot;" id="referrer-policy-origin-when-cross-origin"><span class="secno">3.6. </span><span class="content">"<code>origin-when-cross-origin</code>"</span><span id="referrer-policy-state-origin-when-cross-origin"></span><a class="self-link" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin⑧">"<code>origin-when-cross-origin</code>"</a> policy specifies that a request’s full <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①②">referrerURL</a> is sent as referrer information when making <a data-link-type="dfn" href="#same-origin-referrer-request" id="ref-for-same-origin-referrer-request③">same-origin-referrer requests</a>,
  and only the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin" id="ref-for-ascii-serialisation-of-an-origin②">ASCII serialization</a> of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin③">origin</a> of the request’s <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①③">referrerURL</a> is sent as referrer information when making <a data-link-type="dfn" href="#cross-origin-referrer-request" id="ref-for-cross-origin-referrer-request③">cross-origin-referrer requests</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> For the <a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin①">"<code>origin-when-cross-origin</code>"</a> policy, we also
  consider protocol upgrades, e.g. requests from <code>http://example.com/</code> to <code>https://example.com/</code>, to be <a data-link-type="dfn" href="#cross-origin-referrer-request" id="ref-for-cross-origin-referrer-request④">cross-origin-referrer requests</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin②">"<code>origin-when-cross-origin</code>"</a> policy allows the
  origin of HTTPS referrers to be sent over the network as part of unencrypted
  HTTP requests. The <a data-link-type="dfn" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin①">"<code>strict-origin-when-cross-origin</code>"</a> policy
  addresses this concern.</p>
    <div class="example" id="example-f8a49432">
     <a class="self-link" href="#example-f8a49432"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin③">"<code>origin-when-cross-origin</code>"</a>, then navigations to <code>https://example.com/not-page.html</code> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①⑧"><code>Referer</code></a> header with a value of <code>https://example.com/page.html</code>. 
     <p>Navigations from that same page to <code>https://not.example.com/</code> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3①⑨"><code>Referer</code></a> header with a value of <code>https://example.com/</code>, even to URLs that are not <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①⓪">potentially trustworthy URL</a>s.</p>
    </div>
    <div class="example" id="example-41a40bff"><a class="self-link" href="#example-41a40bff"></a> If a document at <code>https://example-1.com</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin④">"<code>origin-when-cross-origin</code>"</a>, and fetches a module script at <code>https://example-2.com/module.js</code>, which then fetches a descendant script at <code>https://example-1.com/descendant.js</code>, the request to the descendant script would
    send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②⓪"><code>Referer</code></a> header with a value of <code>https://example-2.com/</code>. </div>
    <div class="example" id="example-c7b9549d"><a class="self-link" href="#example-c7b9549d"></a> If a document at <code>https://example-1.com</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin⑤">"<code>origin-when-cross-origin</code>"</a>, and fetches a module script at <code>https://example-2.com/module.js</code>, which then fetches a descendant script at <code>https://example-2.com/descendant.js</code>, the request to the descendant script would
    send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②①"><code>Referer</code></a> header with a value of <code>https://example-2.com/module.js</code>. </div>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.7" data-lt="&quot;strict-origin-when-cross-origin&quot;" id="referrer-policy-strict-origin-when-cross-origin"><span class="secno">3.7. </span><span class="content">"<code>strict-origin-when-cross-origin</code>"</span><a class="self-link" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin⑦"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin②">"<code>strict-origin-when-cross-origin</code>"</a> policy specifies that a request’s full <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①④">referrerURL</a> is sent as referrer information when making <a data-link-type="dfn" href="#same-origin-referrer-request" id="ref-for-same-origin-referrer-request④">same-origin-referrer requests</a>,
  and only the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin" id="ref-for-ascii-serialisation-of-an-origin③">ASCII serialization</a> of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin④">origin</a> of the request’s <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①⑤">referrerURL</a> when making <a data-link-type="dfn" href="#cross-origin-referrer-request" id="ref-for-cross-origin-referrer-request⑤">cross-origin-referrer requests</a>:</p>
    <ul>
     <li>whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①⑥">referrerURL</a> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url⑥">current URL</a> are both <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①①">potentially
      trustworthy URLs</a>, or
     <li>whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①⑦">referrerURL</a> is a non-<a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①②">potentially trustworthy URL</a>.
    </ul>
    <p>Requests whose <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①⑧">referrerURL</a> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①③">potentially trustworthy URL</a> and whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url⑦">current URL</a> is a non-<a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①④">potentially trustworthy URL</a> on the other hand,
  will contain no referrer information. A <code><a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②②">Referer</a></code> HTTP header will not be sent.</p>
    <div class="example" id="example-2e47c322">
     <a class="self-link" href="#example-2e47c322"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin③">"<code>strict-origin-when-cross-origin</code>"</a>, then navigations to <code>https://example.com/not-page.html</code> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②③"><code>Referer</code></a> header with a value of <code>https://example.com/page.html</code>. 
     <p>Navigations from that same page to <code>https://not.example.com/</code> would send a <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②④"><code>Referer</code></a> header with a value of <code>https://example.com/</code>.</p>
     <p>Navigations from that same page to <code><strong>http</strong>://not.example.com/</code> would send no <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②⑤"><code>Referer</code></a> header.</p>
    </div>
    <div class="example" id="example-cd3b6758"><a class="self-link" href="#example-cd3b6758"></a> If a document at <code>https://example.com/page.html</code> sets a policy of <a data-link-type="dfn" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin④">"<code>strict-origin-when-cross-origin</code>"</a>, and fetches a module script
    at <code>https://script.example.com</code> which then fetches a descendant script at <code><strong>http</strong>://descendant.example.com</code>, the request to the descendant
    script would send no <a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②⑥"><code>Referer</code></a> header. </div>
    <p>This policy is the user agent’s <a data-link-type="dfn" href="#default-referrer-policy" id="ref-for-default-referrer-policy">default</a>, and will be applied
  if no policy is otherwise specified.</p>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.8" data-lt="&quot;unsafe-url&quot;" id="referrer-policy-unsafe-url"><span class="secno">3.8. </span><span class="content">"<code>unsafe-url</code>"</span><span id="referrer-policy-state-unsafe-url"></span><a class="self-link" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url⑨">"<code>unsafe-url</code>"</a> policy specifies that a request’s full <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl①⑨">referrerURL</a> is
  sent along for both <a data-link-type="dfn" href="#same-origin-referrer-request" id="ref-for-same-origin-referrer-request⑤">same-origin-referrer requests</a> and <a data-link-type="dfn" href="#cross-origin-referrer-request" id="ref-for-cross-origin-referrer-request⑥">cross-origin-referrer requests</a>.</p>
    <div class="example" id="example-56375f3a"><a class="self-link" href="#example-56375f3a"></a> If a document at <code>https://example.com/sekrit.html</code> sets a policy
    of <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url①">"<code>unsafe-url</code>"</a>, then navigations to <code>http://not.example.com/</code> (and every other origin) would send a <code><a data-link-type="dfn" href="https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3" id="ref-for-rfc.section.10.1.3②⑦">Referer</a></code> HTTP header with a value of <code>https://example.com/sekrit.html</code>. </div>
    <p class="note" role="note"><span class="marker">Note:</span> The policy’s name doesn’t lie; it is unsafe. This policy will leak
  origins and paths from secure resources to insecure origins.
  Carefully consider the impact of setting such a policy for potentially
  sensitive documents.</p>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="3.9" data-lt="The empty string" id="referrer-policy-empty-string"><span class="secno">3.9. </span><span class="content">The empty string</span><a class="self-link" href="#referrer-policy-empty-string" id="ref-for-referrer-policy-empty-string"></a></h3>
    <p>The empty string "" corresponds to no <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy⑤">referrer policy</a>, causing a
  fallback to a <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy⑥">referrer policy</a> defined elsewhere, or in the case where
  no such higher-level policy is available, falling back to the <a data-link-type="dfn" href="#default-referrer-policy" id="ref-for-default-referrer-policy①">default referrer
  policy</a>. This happens in Fetch’s main fetch algorithm, for example.</p>
    <div class="example" id="example-b879d41d"><a class="self-link" href="#example-b879d41d"></a> Given a HTML <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element">a</a></code> element without any declared <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-hyperlink-referrerpolicy" id="ref-for-attr-hyperlink-referrerpolicy">referrerpolicy</a></code> attribute, its referrer policy is the empty string. Thus, navigation requests initiated by
    clicking on that <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element①">a</a></code> element will be sent with the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element②">a</a></code> element’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node document</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container" id="ref-for-concept-document-policy-container">policy container</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy" id="ref-for-policy-container-referrer-policy">referrer policy</a>. If that <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#document" id="ref-for-document">Document</a></code> has the empty string as its referrer policy, the <a href="#determine-requests-referrer" id="ref-for-determine-requests-referrer">§ 8.3 Determine request’s Referrer</a> algorithm will treat the empty string the same as <a data-link-type="dfn" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin⑤">"<code>strict-origin-when-cross-origin</code>"</a>. </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="referrer-policy-delivery"><span class="secno">4. </span><span class="content">Referrer Policy Delivery</span><a class="self-link" href="#referrer-policy-delivery"></a></h2>
    <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy">referrer policy</a> is delivered in one of five ways:</p>
    <ul>
     <li> Via the <code>Referrer-Policy</code> HTTP header (defined
      in <a href="#referrer-policy-header">§ 4.1 Delivery via Referrer-Policy header</a>). 
     <li> Via a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta">meta</a></code> element with a <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-name" id="ref-for-attr-meta-name">name</a></code> of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#meta-referrer" id="ref-for-meta-referrer①"><code>referrer</code></a>. 
     <li> Via a <code>referrerpolicy</code> content attribute on an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element③">a</a></code>, <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/image-maps.html#the-area-element" id="ref-for-the-area-element">area</a></code>, <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element">img</a></code>, <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code>, <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" id="ref-for-the-link-element">link</a></code>, or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script">script</a></code> element. 
     <li> Via the <code><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#link-type-noreferrer" id="ref-for-link-type-noreferrer②">noreferrer</a></code> link relation on an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element④">a</a></code>, or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/image-maps.html#the-area-element" id="ref-for-the-area-element①">area</a></code> element. 
     <li> Implicitly, via inheritance. 
    </ul>
    <h3 class="heading settled" data-level="4.1" id="referrer-policy-header"><span class="secno">4.1. </span><span class="content">Delivery via Referrer-Policy header</span><a class="self-link" href="#referrer-policy-header"></a></h3>
    <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-local-lt="referrer-policy header" data-noexport id="referrer-policy-header-dfn">Referrer-Policy</dfn></code> HTTP header
  specifies the referrer policy that the user agent applies when determining
  what referrer information should be included with requests made, and with <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context">browsing contexts</a> created from the context of the protected
  resource.</p>
    <p>The syntax for the name and value of the header are described by the following
  ABNF grammar. ABNF is defined in <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>, and the <code>#rule</code> ABNF
  extension used below is defined in <a href="https://httpwg.org/specs/rfc9110.html#abnf.extension">Section 5.6.1</a> of <a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a>.</p>
<pre>"Referrer-Policy:" 1#(<a data-link-type="grammar" href="#grammardef-policy-token" id="ref-for-grammardef-policy-token">policy-token</a> / <a data-link-type="grammar" href="#grammardef-extension-token" id="ref-for-grammardef-extension-token">extension-token</a>)
</pre>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-policy-token">policy-token</dfn> = "no-referrer" / "no-referrer-when-downgrade" / "strict-origin" / "strict-origin-when-cross-origin" / "same-origin" / "origin" / "origin-when-cross-origin" / "unsafe-url"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-extension-token">extension-token</dfn> = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1">ALPHA</a> / "-" )
</pre>
    <p class="note" role="note"><span class="marker">Note:</span> The header name does not share the HTTP Referer header’s misspelling.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The purpose of <a data-link-type="grammar" href="#grammardef-extension-token" id="ref-for-grammardef-extension-token①">extension-token</a> is so that
  browsers do not fail to parse the entire header field if it includes an
  unknown policy value. <a href="#unknown-policy-values">§ 11.1 Unknown Policy Values</a> describes in greater detail
  how new policy values can be deployed.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The quotes in the ABNF above are used to indicate literal strings.
  Referrer-Policy header values should not be quoted.</p>
    <p><a href="#integration-with-fetch">§ 5 Integration with Fetch</a> and <a href="#integration-with-html">§ 6 Integration with HTML</a> describe
  how the <code>Referrer-Policy</code> header is processed.</p>
    <section class="informative">
     <h4 class="heading settled" data-level="4.1.1" id="referrer-usage"><span class="secno">4.1.1. </span><span class="content">Usage</span><a class="self-link" href="#referrer-usage"></a></h4>
     <p><em>This section is not normative.</em></p>
     <p>A protected resource can prevent referrer leakage by specifying <code>no-referrer</code> as the value of its <code>Referrer-Policy</code> header:</p>
<pre>Referrer-Policy: no-referrer
</pre>
     <p>This will cause all requests made from the protected resource’s
    context to have an empty <code>Referer</code> [sic] header.</p>
    </section>
    <section class="informative">
     <h3 class="heading settled" data-level="4.2" id="referrer-policy-delivery-meta"><span class="secno">4.2. </span><span class="content">Delivery via <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta①">meta</a></code></span><a class="self-link" href="#referrer-policy-delivery-meta"></a></h3>
     <p><em>This section is not normative.</em></p>
     <p>The HTML Standard defines the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#meta-referrer" id="ref-for-meta-referrer②"><code>referrer</code></a> keyword for the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta②">meta</a></code> element, which allows setting the <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy⑦">referrer
    policy</a> via markup.</p>
    </section>
    <section class="informative">
     <h3 class="heading settled" data-level="4.3" id="referrer-policy-delivery-referrer-attribute"><span class="secno">4.3. </span><span class="content">Delivery
    via a <code>referrerpolicy</code> content attribute</span><a class="self-link" href="#referrer-policy-delivery-referrer-attribute"></a></h3>
     <p><em>This section is not normative.</em></p>
     <p>The HTML Standard defines the concept of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#referrer-policy-attribute" id="ref-for-referrer-policy-attribute">referrer policy
    attributes</a> which applies to several of its elements, for example:</p>
<pre class="example" id="example-d7516db8"><a class="self-link" href="#example-d7516db8"></a><code class="lang-html highlight"><c- p>&lt;</c-><c- f>a</c-> <c- e>href</c-><c- o>=</c-><c- s>"http://example.com"</c-> <c- e>referrerpolicy</c-><c- o>=</c-><c- s>"origin"</c-><c- p>></c->
</code></pre>
    </section>
    <section class="informative">
     <h3 class="heading settled" data-level="4.4" id="referrer-policy-inheritance"><span class="secno">4.4. </span><span class="content"><a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy⑧">Referrer Policy</a> Inheritance</span><span id="referrer-policy-delivery-nested"></span><span id="referrer-policy-delivery-implicit"></span><a class="self-link" href="#referrer-policy-inheritance"></a></h3>
     <p><em>This section is not normative.</em></p>
     <p>Referrer policy is inherited following the inheritance mechanism of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container" id="ref-for-policy-container">policy containers</a>, as defined by HTML.</p>
    </section>
   </section>
   <section class="informative">
    <h2 class="heading settled" data-level="5" id="integration-with-fetch"><span class="secno">5. </span><span class="content">Integration with Fetch</span><a class="self-link" href="#integration-with-fetch"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>The Fetch specification calls out to <a href="#set-requests-referrer-policy-on-redirect" id="ref-for-set-requests-referrer-policy-on-redirect">§ 8.2 Set request’s referrer policy on redirect</a> before <a href="https://fetch.spec.whatwg.org/#http-redirect-fetch">Step 19 of the HTTP-redirect fetch</a>, so
  that a request’s referrer policy can be updated before following a redirect.</p>
    <p>The Fetch specification calls out to <a href="#determine-requests-referrer" id="ref-for-determine-requests-referrer①">§ 8.3 Determine request’s Referrer</a> as <a href="https://fetch.spec.whatwg.org/#main-fetch">Step 8 of the Main fetch algorithm</a>, and uses the
  result to set the <var>request</var>’s <code>referrer</code> property. Fetch
  is responsible for serializing the URL provided, and setting the
  `<code>Referer</code>` header on <var>request</var>.</p>
   </section>
   <section class="informative">
    <h2 class="heading settled" data-level="6" id="integration-with-html"><span class="secno">6. </span><span class="content">Integration with HTML</span><a class="self-link" href="#integration-with-html"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>The HTML Standard determines the <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy⑨">referrer policy</a> of any response
  received during <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#navigate" id="ref-for-navigate">navigation</a> or while <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker" id="ref-for-run-a-worker">running a worker</a>, and uses
  the result to set the resulting <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#document" id="ref-for-document①">Document</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container" id="ref-for-concept-document-policy-container①">policy
  container</a>’s or <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-policy-container" id="ref-for-concept-workerglobalscope-policy-container">policy
  container</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy" id="ref-for-policy-container-referrer-policy①">referrer policy</a>.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="integration-with-css"><span class="secno">7. </span><span class="content">Integration with CSS</span><a class="self-link" href="#integration-with-css"></a></h2>
    <p>The CSS Standard does not specify how it fetches resources referenced from
  stylesheets. However, implementations should be sure to set the
  referrer-related properties of any <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">requests</a> initiated by stylesheets
  as follows:</p>
    <ol>
     <li>
       If a <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#css-style-sheet" id="ref-for-css-style-sheet">CSS style sheet</a> is responsible for the request,
       and its <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-location" id="ref-for-concept-css-style-sheet-location">location</a> is non-null,
       set the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer">referrer</a> to its <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-location" id="ref-for-concept-css-style-sheet-location①">location</a>, and the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy①">referrer
       policy</a> to its <a data-link-type="dfn" href="#cssstylesheet-referrer-policy" id="ref-for-cssstylesheet-referrer-policy">referrer policy</a>. 
      <p class="issue" id="issue-a01fbbf2"><a class="self-link" href="#issue-a01fbbf2"></a> This requires that CSS style sheets process `Referrer-Policy`
       headers, and store a <dfn class="dfn-paneled" data-dfn-for="CSSStyleSheet" data-dfn-type="dfn" data-noexport id="cssstylesheet-referrer-policy">referrer policy</dfn> in the same way that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy" id="ref-for-policy-container-referrer-policy②">Documents
       do</a>.</p>
     <li> If a <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#css-style-sheet" id="ref-for-css-style-sheet①">CSS style sheet</a> with a null <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-location" id="ref-for-concept-css-style-sheet-location②">location</a> is responsible
      for the request, set the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer①">referrer</a> to its <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-owner-node" id="ref-for-concept-css-style-sheet-owner-node">owner node</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document①">node document</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url">URL</a>, and the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy②">referrer policy</a> to its <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-owner-node" id="ref-for-concept-css-style-sheet-owner-node①">owner node</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document②">node document</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container" id="ref-for-concept-document-policy-container②">policy container</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy" id="ref-for-policy-container-referrer-policy③">referrer policy</a>. 
     <li> Otherwise, a <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#css-declaration-block" id="ref-for-css-declaration-block">CSS declaration block</a> that was created by the
       embedder is responsible for the request - either from parsing of an
       element’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-style-attribute" id="ref-for-the-style-attribute">style attribute</a>, or to implement an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/rendering.html#presentational-hints" id="ref-for-presentational-hints">presentational
       hint</a> for an element. We assume that in this case the <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#css-declaration-block" id="ref-for-css-declaration-block①">CSS
       declaration block</a>’s <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node" id="ref-for-cssstyledeclaration-owner-node">owner node</a> points to that element, and set the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer②">referrer</a> to the
       block’s <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node" id="ref-for-cssstyledeclaration-owner-node①">owner node</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document③">node
       document</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url①">URL</a>, and the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy③">referrer policy</a> to the block’s <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node" id="ref-for-cssstyledeclaration-owner-node②">owner node</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document④">node document</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container" id="ref-for-concept-document-policy-container③">policy container</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy" id="ref-for-policy-container-referrer-policy④">referrer policy</a>. 
    </ol>
    <p class="note" role="note"><span class="marker">Note:</span> Both the value of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">request</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer③">referrer</a> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy④">referrer policy</a> are set based on the values at the
  time a given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④">request</a> is created. If a document’s referrer policy
  changes during its lifetime, the policy associated with inline stylesheet
  requests will also change.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="algorithms"><span class="secno">8. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
    <h3 class="heading settled" data-level="8.1" id="parse-referrer-policy-from-header"><span class="secno">8.1. </span><span class="content"> Parse a referrer policy from a <a data-link-type="dfn" href="#referrer-policy-header-dfn" id="ref-for-referrer-policy-header-dfn"><code>Referrer-Policy</code></a> header </span><a class="self-link" href="#parse-referrer-policy-from-header"></a></h3>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a> <var>response</var>, the following steps return a <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy①⓪">referrer policy</a> according to <var>response</var>’s
  `<code>Referrer-Policy</code>` header:</p>
    <ol>
     <li> Let <var>policy-tokens</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#extract-header-list-values" id="ref-for-extract-header-list-values">extracting header list values</a> given
      `<code>Referrer-Policy</code>` and <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>. 
     <li> Let <var>policy</var> be the empty string. 
     <li>
       For each <var>token</var> in <var>policy-tokens</var>, if <var>token</var> is a <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy①①">referrer
      policy</a> and <var>token</var> is not the empty string, then set <var>policy</var> to <var>token</var>. 
      <p class="note" role="note"><span class="marker">Note:</span> This algorithm loops over multiple policy values to allow
          deployment of new policy values with fallbacks for older user
          agents, as described in <a href="#unknown-policy-values">§ 11.1 Unknown Policy Values</a>.</p>
     <li> Return <var>policy</var>. 
    </ol>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="8.2" data-lt="Set request’s referrer policy on redirect" id="set-requests-referrer-policy-on-redirect"><span class="secno">8.2. </span><span class="content"> Set <var>request</var>’s referrer policy on redirect </span><a class="self-link" href="#set-requests-referrer-policy-on-redirect" id="ref-for-set-requests-referrer-policy-on-redirect①"></a></h3>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤">request</a> <var>request</var> and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a> <var>actualResponse</var>,
  this algorithm updates <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy⑤">referrer policy</a> according to the Referrer-Policy header (if any) in <var>actualResponse</var>.</p>
    <ol>
     <li> Let <var>policy</var> be the result of executing <a href="#parse-referrer-policy-from-header">§ 8.1 Parse a referrer policy from a Referrer-Policy header</a> on <var>actualResponse</var>. 
     <li>If <var>policy</var> is not the empty string, then set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy⑥">referrer policy</a> to <var>policy</var>.
    </ol>
    <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="8.3" data-lt="Determine request’s Referrer" id="determine-requests-referrer"><span class="secno">8.3. </span><span class="content"> Determine <var>request</var>’s Referrer </span><a class="self-link" href="#determine-requests-referrer" id="ref-for-determine-requests-referrer②"></a></h3>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥">request</a> <var>request</var>, we can determine the correct
  referrer information to send by examining its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy⑦">referrer policy</a> as detailed in the following steps, which return either <code>no referrer</code> or a URL:</p>
    <ol>
     <li> Let <var>policy</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy⑧">referrer policy</a>. 
     <li> Let <var>environment</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client②">client</a>. 
     <li>
       Switch on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer④">referrer</a>: 
      <dl class="switch">
       <dt>"<code>client</code>"
       <dd>
        <ol>
         <li>
           If <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global
              object</a> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code> object, then 
          <ol>
           <li>Let <var>document</var> be
                the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-document-window" id="ref-for-concept-document-window">associated <code>Document</code></a> of <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①">global object</a>.
           <li>If <var>document</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin">origin</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>,
                return <code>no referrer</code>.
           <li>While <var>document</var> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/embedded-content.html#an-iframe-srcdoc-document" id="ref-for-an-iframe-srcdoc-document">an <code>iframe srcdoc</code> document</a>, let <var>document</var> be <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc" id="ref-for-concept-document-bc">browsing context</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-container" id="ref-for-browsing-context-container">browsing context
                container</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document⑤">node document</a>.
           <li>Let <var>referrerSource</var> be <var>document</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url②">URL</a>.
          </ol>
         <li>Otherwise, let <var>referrerSource</var> be <var>environment</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url" id="ref-for-concept-environment-creation-url">creation
            URL</a>.
        </ol>
       <dt>a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a>
       <dd>Let <var>referrerSource</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer⑤">referrer</a>.
      </dl>
      <p class="note" role="note"><span class="marker">Note:</span> If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer" id="ref-for-concept-request-referrer⑥">referrer</a> is
      "<code>no-referrer</code>", Fetch will not call into this algorithm.</p>
     <li> Let request’s <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="referrerurl">referrerURL</dfn> be the result of <a href="#strip-url">stripping <var>referrerSource</var> for use as a referrer.</a> 
     <li> Let <var>referrerOrigin</var> be the result of <a href="#strip-url">stripping <var>referrerSource</var> for use as a
      referrer</a>, with the <code><a data-link-type="dfn" href="#origin-only-flag" id="ref-for-origin-only-flag">origin-only flag</a></code> set to <code>true</code>. 
     <li> If the result of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">serializing</a> <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②⓪">referrerURL</a> is a string whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-length" id="ref-for-string-length">length</a> is greater than 4096, set <span>referrerURL</span> to <var>referrerOrigin</var>. 
     <li> The user agent MAY alter <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②①">referrerURL</a> or <var>referrerOrigin</var> at this point to
      enforce arbitrary policy considerations in the interests of minimizing data leakage. For
      example, the user agent could strip the URL down to an origin, modify its <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host" id="ref-for-concept-url-host">host</a>, replace it with an empty string, etc. 
     <li>
       Execute the statements corresponding to the value of <var>policy</var>:<br> Note: If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy⑨">referrer policy</a> is
        the empty string, Fetch will not call into this algorithm. 
      <dl class="switch">
       <dt><a data-link-type="dfn" href="#referrer-policy-no-referrer" id="ref-for-referrer-policy-no-referrer②">"<code>no-referrer</code>"</a>
       <dd>Return <code>no referrer</code>
       <dt><a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin④">"<code>origin</code>"</a>
       <dd>Return <var>referrerOrigin</var>
       <dt><a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url②">"<code>unsafe-url</code>"</a>
       <dd>Return <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②②">referrerURL</a>.
       <dt><a data-link-type="dfn" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin⑤">"<code>strict-origin</code>"</a>
       <dd>
        <ol>
         <li> If <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②③">referrerURL</a> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①⑤">potentially trustworthy URL</a> and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url⑧">current URL</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①⑥">potentially trustworthy URL</a>, then
              return <code>no referrer</code>. 
         <li>Return <var>referrerOrigin</var>. 
        </ol>
       <dt><a data-link-type="dfn" href="#referrer-policy-strict-origin-when-cross-origin" id="ref-for-referrer-policy-strict-origin-when-cross-origin⑥">"<code>strict-origin-when-cross-origin</code>"</a>
       <dd>
        <ol>
         <li> If the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin②">origin</a> of <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②④">referrerURL</a> and the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin③">origin</a> of <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url⑨">current URL</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin①">the
              same</a>, then return <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②⑤">referrerURL</a>. 
         <li> If <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②⑥">referrerURL</a> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①⑦">potentially trustworthy URL</a> and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①⓪">current URL</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①⑧">potentially trustworthy URL</a>, then
              return <code>no referrer</code>. 
         <li>Return <var>referrerOrigin</var>. 
        </ol>
       <dt><a data-link-type="dfn" href="#referrer-policy-same-origin" id="ref-for-referrer-policy-same-origin③">"<code>same-origin</code>"</a>
       <dd>
        <ol>
         <li>
           If the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin④">origin</a> of <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②⑦">referrerURL</a> and the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑤">origin</a> of <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①①">current URL</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin②">the
              same</a>, then return <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②⑧">referrerURL</a>. 
          <p class="note" role="note"><span class="marker">Note:</span> This same-origin check determines whether or not the request is <a data-link-type="dfn" href="#same-origin-referrer-request" id="ref-for-same-origin-referrer-request⑥">same-origin-referrer</a>.</p>
         <li>Return <code>no referrer</code>. 
        </ol>
       <dt><a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin⑥">"<code>origin-when-cross-origin</code>"</a>
       <dd>
        <ol>
         <li> If the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑥">origin</a> of <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl②⑨">referrerURL</a> and the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑦">origin</a> of <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①②">current URL</a> are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin③">the
              same</a>, then return <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl③⓪">referrerURL</a>. 
         <li> Return <var>referrerOrigin</var>. 
        </ol>
       <dt><a data-link-type="dfn" href="#referrer-policy-no-referrer-when-downgrade" id="ref-for-referrer-policy-no-referrer-when-downgrade②">"<code>no-referrer-when-downgrade</code>"</a>
       <dd>
        <ol>
         <li> If <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl③①">referrerURL</a> is a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url①⑨">potentially trustworthy URL</a> and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①③">current URL</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url" id="ref-for-potentially-trustworthy-url②⓪">potentially trustworthy URL</a>, then
              return <code>no referrer</code>. 
         <li>Return <a data-link-type="dfn" href="#referrerurl" id="ref-for-referrerurl③②">referrerURL</a>. 
        </ol>
      </dl>
    </ol>
    <h3 class="heading settled" data-level="8.4" id="strip-url"><span class="secno">8.4. </span><span class="content"> Strip <var>url</var> for use as a referrer </span><a class="self-link" href="#strip-url"></a></h3>
    <p>Certain portions of URLs must not be included when sending a URL as the value
  of a `<code>Referer</code>` header: a URLs fragment, username, and password
  components must be stripped from the URL before it’s sent out. This
  algorithm accepts a <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="origin-only-flag">origin-only flag</dfn></code>, which defaults
  to <code>false</code>. If set to <code>true</code>, the algorithm will
  additionally remove the URL’s path and query components, leaving only the
  scheme, host, and port.</p>
    <ol>
     <li><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <var>url</var> is a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a>.
     <li> If <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme">local scheme</a>, then
      return <code>no referrer</code>. 
     <li> Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-username" id="ref-for-concept-url-username">username</a> to the empty string. 
     <li> Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-password" id="ref-for-concept-url-password">password</a> to the empty string. 
     <li> Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment">fragment</a> to <code>null</code>. 
     <li>
       If the <code><a data-link-type="dfn" href="#origin-only-flag" id="ref-for-origin-only-flag①">origin-only flag</a></code> is <code>true</code>,
      then: 
      <ol>
       <li> Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-path">path</a> to « the empty string ». 
       <li> Set <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-query" id="ref-for-concept-url-query">query</a> to <code>null</code>. 
      </ol>
     <li> Return <var>url</var>. 
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="privacy"><span class="secno">9. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
    <h3 class="heading settled" data-level="9.1" id="user-controls"><span class="secno">9.1. </span><span class="content">User Controls</span><a class="self-link" href="#user-controls"></a></h3>
    <p>Nothing in this specification should be interpreted as preventing user
  agents from offering options to users which would change the information
  sent out via a `<code>Referer</code>` header. For instance, user agents
  MAY allow users to suppress the referrer header entirely, regardless of the
  active <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy①②">referrer policy</a> on a page.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="security"><span class="secno">10. </span><span class="content">Security Considerations</span><a class="self-link" href="#security"></a></h2>
    <h3 class="heading settled" data-level="10.1" id="information-leakage"><span class="secno">10.1. </span><span class="content">Information Leakage</span><a class="self-link" href="#information-leakage"></a></h3>
    <p>The <a data-link-type="dfn" href="#referrer-policy" id="ref-for-referrer-policy①③">referrer policies</a> <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin⑤">"<code>origin</code>"</a>, <a data-link-type="dfn" href="#referrer-policy-origin-when-cross-origin" id="ref-for-referrer-policy-origin-when-cross-origin⑦">"<code>origin-when-cross-origin</code>"</a> and <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url③">"<code>unsafe-url</code>"</a> might leak the origin and the URL of
  a secure site respectively via insecure transport.</p>
    <p>Those three policies are included in the spec nevertheless to lower the friction
  of sites adopting secure transport.</p>
    <p>Authors wanting to ensure that they do not leak any more information than
  the default policy should instead use the policy states <a data-link-type="dfn" href="#referrer-policy-same-origin" id="ref-for-referrer-policy-same-origin④">"<code>same-origin</code>"</a>, <a data-link-type="dfn" href="#referrer-policy-strict-origin" id="ref-for-referrer-policy-strict-origin⑥">"<code>strict-origin</code>"</a>, or <a data-link-type="dfn" href="#referrer-policy-no-referrer" id="ref-for-referrer-policy-no-referrer③">"<code>no-referrer</code>"</a>.</p>
    <h3 class="heading settled" data-level="10.2" id="downgrade"><span class="secno">10.2. </span><span class="content">Downgrade to less strict policies</span><a class="self-link" href="#downgrade"></a></h3>
    <p>The spec does not forbid downgrading to less strict policies, e.g., from <a data-link-type="dfn" href="#referrer-policy-no-referrer" id="ref-for-referrer-policy-no-referrer④">"<code>no-referrer</code>"</a> to <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url④">"<code>unsafe-url</code>"</a>.</p>
    <p>On the one hand, it is not clear which policy is more strict for all possible
  pairs of policies: While <a data-link-type="dfn" href="#referrer-policy-no-referrer-when-downgrade" id="ref-for-referrer-policy-no-referrer-when-downgrade③">"<code>no-referrer-when-downgrade</code>"</a> will
  not leak any information over insecure transport, and <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin⑥">"<code>origin</code>"</a> will, the latter reveals less information
  across cross-origin navigations.</p>
    <p>On the other hand, allowing for setting less strict policies enables authors
  to define safe fallbacks as described in <a href="#unknown-policy-values">§ 11.1 Unknown Policy Values</a>.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="11" id="authoring"><span class="secno">11. </span><span class="content">Authoring Considerations</span><a class="self-link" href="#authoring"></a></h2>
    <h3 class="heading settled" data-level="11.1" id="unknown-policy-values"><span class="secno">11.1. </span><span class="content">Unknown Policy Values</span><a class="self-link" href="#unknown-policy-values"></a></h3>
    <p>As described in <a href="#parse-referrer-policy-from-header">§ 8.1 Parse a referrer policy from a Referrer-Policy header</a> and in the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta③">meta</a></code> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#meta-referrer" id="ref-for-meta-referrer③"><code>referrer</code></a> algorithm, unknown
  policy values will be ignored, and when multiple sources specify a
  referrer policy, the value of the latest one will be used. This makes
  it possible to deploy new policy values.</p>
    <div class="example" id="example-1ba8d4a5"><a class="self-link" href="#example-1ba8d4a5"></a> Suppose older user agents don’t understand
    the <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url⑤">"<code>unsafe-url</code>"</a> policy. A site can specify
    an <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin⑦">"<code>origin</code>"</a> policy followed by an <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url⑥">"<code>unsafe-url</code>"</a> policy: older user agents will ignore the
    unknown <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url⑦">"<code>unsafe-url</code>"</a> value and use <a data-link-type="dfn" href="#referrer-policy-origin" id="ref-for-referrer-policy-origin⑧">"<code>origin</code>"</a>, while newer user agents will use <a data-link-type="dfn" href="#referrer-policy-unsafe-url" id="ref-for-referrer-policy-unsafe-url⑧">"<code>unsafe-url</code>"</a> because it is the last to be processed. </div>
    <div class="example" id="example-3966e12b">
     <a class="self-link" href="#example-3966e12b"></a> To specify multiple policy values in the Referrer-Policy header, a site can
    send multiple Referrer-Policy headers: 
<pre>Referrer-Policy: no-referrer
Referrer-Policy: unsafe-url
</pre>
     <p>or, equivalently, multiple comma-separated header values:</p>
<pre>Referrer-Policy: no-referrer,unsafe-url
</pre>
    </div>
    <p>This behavior does not, however, apply to
  the <code>referrerpolicy</code> attribute. Authors may dynamically set
  and get the <code>referrerpolicy</code> attribute to detect whether a
  particular policy value is supported.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="12" id="acknowledgements"><span class="secno">12. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>This specification is based in large part on Adam Barth and Jochen Eisinger’s <a href="http://wiki.whatwg.org/wiki/Meta_referrer">Meta referrer</a> document.</p>
    <p>Francois
  Marier <a href="https://lists.w3.org/Archives/Public/public-webappsec/2016Mar/0085.html">contributed</a> the <code>same-origin</code>, <code>strict-origin</code>,
  and <code>strict-origin-when-cross-origin</code> policies.</p>
   </section>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <section>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
   </section>
  </div>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-referrerpolicy">""</a><span>, in § 3</span>
   <li><a href="#cross-origin-referrer-request">cross-origin-referrer request</a><span>, in § 2</span>
   <li><a href="#default-referrer-policy">default referrer policy</a><span>, in § 3</span>
   <li><a href="#determine-requests-referrer">Determine request’s Referrer</a><span>, in § 8.2</span>
   <li><a href="#grammardef-extension-token">extension-token</a><span>, in § 4.1</span>
   <li>
    "no-referrer"
    <ul>
     <li><a href="#referrer-policy-no-referrer">definition of</a><span>, in § 3</span>
     <li><a href="#dom-referrerpolicy-no-referrer">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
   <li>
    "no-referrer-when-downgrade"
    <ul>
     <li><a href="#referrer-policy-no-referrer-when-downgrade">definition of</a><span>, in § 3.1</span>
     <li><a href="#dom-referrerpolicy-no-referrer-when-downgrade">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
   <li>
    "origin"
    <ul>
     <li><a href="#referrer-policy-origin">definition of</a><span>, in § 3.3</span>
     <li><a href="#dom-referrerpolicy-origin">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
   <li><a href="#origin-only-flag">origin-only flag</a><span>, in § 8.4</span>
   <li>
    "origin-when-cross-origin"
    <ul>
     <li><a href="#referrer-policy-origin-when-cross-origin">definition of</a><span>, in § 3.5</span>
     <li><a href="#dom-referrerpolicy-origin-when-cross-origin">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
   <li><a href="#grammardef-policy-token">policy-token</a><span>, in § 4.1</span>
   <li>
    referrer policy
    <ul>
     <li><a href="#referrer-policy">definition of</a><span>, in § 3</span>
     <li><a href="#cssstylesheet-referrer-policy">dfn for CSSStyleSheet</a><span>, in § 7</span>
    </ul>
   <li><a href="#referrer-policy-header-dfn">Referrer-Policy</a><span>, in § 4.1</span>
   <li><a href="#enumdef-referrerpolicy">ReferrerPolicy</a><span>, in § 3</span>
   <li><a href="#referrer-policy-header-dfn">referrer-policy header</a><span>, in § 4.1</span>
   <li><a href="#referrerurl">referrerURL</a><span>, in § 8.3</span>
   <li>
    "same-origin"
    <ul>
     <li><a href="#referrer-policy-same-origin">definition of</a><span>, in § 3.2</span>
     <li><a href="#dom-referrerpolicy-same-origin">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
   <li><a href="#same-origin-referrer-request">same-origin-referrer request</a><span>, in § 2</span>
   <li><a href="#set-requests-referrer-policy-on-redirect">Set request’s referrer policy on redirect</a><span>, in § 8.1</span>
   <li>
    "strict-origin"
    <ul>
     <li><a href="#referrer-policy-strict-origin">definition of</a><span>, in § 3.4</span>
     <li><a href="#dom-referrerpolicy-strict-origin">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
   <li>
    "strict-origin-when-cross-origin"
    <ul>
     <li><a href="#referrer-policy-strict-origin-when-cross-origin">definition of</a><span>, in § 3.6</span>
     <li><a href="#dom-referrerpolicy-strict-origin-when-cross-origin">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
   <li><a href="#referrer-policy-empty-string">The empty string</a><span>, in § 3.8</span>
   <li>
    "unsafe-url"
    <ul>
     <li><a href="#referrer-policy-unsafe-url">definition of</a><span>, in § 3.7</span>
     <li><a href="#dom-referrerpolicy-unsafe-url">enum-value for ReferrerPolicy</a><span>, in § 3</span>
    </ul>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSSOM-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a06e5a78">css declaration block</span>
     <li><span class="dfn-paneled" id="9ca506a8">css style sheet</span>
     <li><span class="dfn-paneled" id="bbc31c9d">location</span>
     <li><span class="dfn-paneled" id="eab73120">owner node <small>(for CSSStyleDeclaration)</small></span>
     <li><span class="dfn-paneled" id="06f8d393">owner node <small>(for CSSStyleSheet)</small></span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5216e1a0">node document</span>
     <li><span class="dfn-paneled" id="c62cd7cf">origin</span>
     <li><span class="dfn-paneled" id="347e8fe9">url</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f9da6f1f">Request</span>
     <li><span class="dfn-paneled" id="857d5516">client</span>
     <li><span class="dfn-paneled" id="3f2ca4de">current url</span>
     <li><span class="dfn-paneled" id="3be1d4ac">extracting header list values</span>
     <li><span class="dfn-paneled" id="a33db89a">fetch</span>
     <li><span class="dfn-paneled" id="f7b00a8b">header list</span>
     <li><span class="dfn-paneled" id="63340982">local scheme</span>
     <li><span class="dfn-paneled" id="358f1dbd">referrer</span>
     <li><span class="dfn-paneled" id="07582c28">referrer policy</span>
     <li><span class="dfn-paneled" id="55213b5b">request</span>
     <li><span class="dfn-paneled" id="ee7bba09">response</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="60e326a9">Document</span>
     <li><span class="dfn-paneled" id="5d7209e9">Window</span>
     <li><span class="dfn-paneled" id="83c59a3a">WorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="68bf3d31">a</span>
     <li><span class="dfn-paneled" id="9c5b5827">an iframe srcdoc document</span>
     <li><span class="dfn-paneled" id="a1a807e5">area</span>
     <li><span class="dfn-paneled" id="b410a6ef">ascii serialization of an origin</span>
     <li><span class="dfn-paneled" id="12e9e1d0">associated document</span>
     <li><span class="dfn-paneled" id="faf954d6">browsing context</span>
     <li><span class="dfn-paneled" id="3b2ff63e">browsing context <small>(for Document)</small></span>
     <li><span class="dfn-paneled" id="7939ecaf">browsing context container</span>
     <li><span class="dfn-paneled" id="fa5ee9c5">creation url</span>
     <li><span class="dfn-paneled" id="3e12e042">environment settings object</span>
     <li><span class="dfn-paneled" id="8a30477b">global object</span>
     <li><span class="dfn-paneled" id="87fcd40c">iframe</span>
     <li><span class="dfn-paneled" id="f0811ff8">img</span>
     <li><span class="dfn-paneled" id="6cfa013d">link</span>
     <li><span class="dfn-paneled" id="64b89595">meta</span>
     <li><span class="dfn-paneled" id="a23d5e9f">name</span>
     <li><span class="dfn-paneled" id="5abc471e">navigation</span>
     <li><span class="dfn-paneled" id="09289012">noreferrer</span>
     <li><span class="dfn-paneled" id="b01b1359">opaque origin</span>
     <li><span class="dfn-paneled" id="086e3aff">origin</span>
     <li><span class="dfn-paneled" id="b33787b2">policy container</span>
     <li><span class="dfn-paneled" id="08639fbc">policy container <small>(for Document)</small></span>
     <li><span class="dfn-paneled" id="432147ee">policy container <small>(for WorkerGlobalScope)</small></span>
     <li><span class="dfn-paneled" id="fefe9144">presentational hints</span>
     <li><span class="dfn-paneled" id="f588bce5">referrer</span>
     <li><span class="dfn-paneled" id="cd03669e">referrer policy</span>
     <li><span class="dfn-paneled" id="ea4eef27">referrer policy attribute</span>
     <li><span class="dfn-paneled" id="50093b9d">referrerpolicy</span>
     <li><span class="dfn-paneled" id="8d526929">running a worker</span>
     <li><span class="dfn-paneled" id="7393da89">same origin</span>
     <li><span class="dfn-paneled" id="0cf3964f">script</span>
     <li><span class="dfn-paneled" id="3114a761">style attribute</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="77b4c09a">assert</span>
     <li><span class="dfn-paneled" id="0fa357c3">length</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC5234]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="41a7917e">alpha</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC9110]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="3bdaef91">referer</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SECURE-CONTEXTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9c5d9c4d">potentially trustworthy url</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ed948033">fragment</span>
     <li><span class="dfn-paneled" id="b85ee3be">host</span>
     <li><span class="dfn-paneled" id="959ad97b">origin</span>
     <li><span class="dfn-paneled" id="a1288f2a">password</span>
     <li><span class="dfn-paneled" id="c0868016">path</span>
     <li><span class="dfn-paneled" id="3ab2ec8b">query</span>
     <li><span class="dfn-paneled" id="3a711be7">scheme</span>
     <li><span class="dfn-paneled" id="dcffbccd">url</span>
     <li><span class="dfn-paneled" id="5442ea33">url serializer</span>
     <li><span class="dfn-paneled" id="218c9455">username</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-cssom-1">[CSSOM-1]
   <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://drafts.csswg.org/cssom/"><cite>CSS Object Model (CSSOM)</cite></a>. URL: <a href="https://drafts.csswg.org/cssom/">https://drafts.csswg.org/cssom/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
   <dt id="biblio-rfc9110">[RFC9110]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP Semantics</cite></a>. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/"><cite>Secure Contexts</cite></a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-capability-urls">[CAPABILITY-URLS]
   <dd>Jeni Tennison. <a href="https://w3ctag.github.io/capability-urls/"><cite>Good Practices for Capability URLs</cite></a>. URL: <a href="https://w3ctag.github.io/capability-urls/">https://w3ctag.github.io/capability-urls/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>enum</c-> <a href="#enumdef-referrerpolicy"><code><c- g>ReferrerPolicy</c-></code></a> {
  <a href="#dom-referrerpolicy"><code><c- s>""</c-></code></a>,
  <a href="#dom-referrerpolicy-no-referrer"><code><c- s>"no-referrer"</c-></code></a>,
  <a href="#dom-referrerpolicy-no-referrer-when-downgrade"><code><c- s>"no-referrer-when-downgrade"</c-></code></a>,
  <a href="#dom-referrerpolicy-same-origin"><code><c- s>"same-origin"</c-></code></a>,
  <a href="#dom-referrerpolicy-origin"><code><c- s>"origin"</c-></code></a>,
  <a href="#dom-referrerpolicy-strict-origin"><code><c- s>"strict-origin"</c-></code></a>,
  <a href="#dom-referrerpolicy-origin-when-cross-origin"><code><c- s>"origin-when-cross-origin"</c-></code></a>,
  <a href="#dom-referrerpolicy-strict-origin-when-cross-origin"><code><c- s>"strict-origin-when-cross-origin"</c-></code></a>,
  <a href="#dom-referrerpolicy-unsafe-url"><code><c- s>"unsafe-url"</c-></code></a>
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> This requires that CSS style sheets process `Referrer-Policy`
       headers, and store a <span>referrer policy</span> in the same way that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy">Documents
       do</a>. <a class="issue-return" href="#issue-a01fbbf2" title="Jump to section">↵</a></div>
  </div>
  <details class="mdn-anno unpositioned" data-anno-for="referrer-policy-delivery-meta">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta/name" title="The <meta> element can be used to provide document metadata in terms of name-value pairs, with the name attribute giving the metadata name, and the content attribute giving the value.">Element/meta/name</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span>
     <hr>
     <span class="opera yes"><span>Opera</span><span>12.1+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>IE</span><span>6+</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>12.1+</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="referrer-policy-header">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy" title="The Referrer-Policy HTTP header controls how much referrer information (sent with the Referer header) should be included with requests. Aside from the HTTP header, you can set this policy in HTML.">Headers/Referrer-Policy</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>50+</span></span><span class="safari yes"><span>Safari</span><span>11.1+</span></span><span class="chrome yes"><span>Chrome</span><span>56+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>12+</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.2+</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"06f8d393": {"dfnID":"06f8d393","dfnText":"owner node (for CSSStyleSheet)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-css-style-sheet-owner-node"},{"id":"ref-for-concept-css-style-sheet-owner-node\u2460"}],"title":"7. Integration with CSS"}],"url":"https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-owner-node"},
"07582c28": {"dfnID":"07582c28","dfnText":"referrer policy","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-referrer-policy"}],"title":"4. Referrer Policy Delivery"},{"refs":[{"id":"ref-for-concept-request-referrer-policy\u2460"},{"id":"ref-for-concept-request-referrer-policy\u2461"},{"id":"ref-for-concept-request-referrer-policy\u2462"},{"id":"ref-for-concept-request-referrer-policy\u2463"}],"title":"7. Integration with CSS"},{"refs":[{"id":"ref-for-concept-request-referrer-policy\u2464"},{"id":"ref-for-concept-request-referrer-policy\u2465"}],"title":"8.2. \n    Set request\u2019s referrer policy on redirect\n  "},{"refs":[{"id":"ref-for-concept-request-referrer-policy\u2466"},{"id":"ref-for-concept-request-referrer-policy\u2467"},{"id":"ref-for-concept-request-referrer-policy\u2468"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-referrer-policy"},
"08639fbc": {"dfnID":"08639fbc","dfnText":"policy container (for Document)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-policy-container"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-concept-document-policy-container\u2460"}],"title":"6. Integration with HTML"},{"refs":[{"id":"ref-for-concept-document-policy-container\u2461"},{"id":"ref-for-concept-document-policy-container\u2462"}],"title":"7. Integration with CSS"}],"url":"https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container"},
"086e3aff": {"dfnID":"086e3aff","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-origin"}],"title":"3.1. \"no-referrer\""},{"refs":[{"id":"ref-for-concept-origin\u2460"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-concept-origin\u2461"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-concept-origin\u2462"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-concept-origin\u2463"}],"title":"3.7. \"strict-origin-when-cross-origin\""}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"},
"09289012": {"dfnID":"09289012","dfnText":"noreferrer","external":true,"refSections":[{"refs":[{"id":"ref-for-link-type-noreferrer"}],"title":"1. Introduction"},{"refs":[{"id":"ref-for-link-type-noreferrer\u2460"}],"title":"3. Referrer Policies"},{"refs":[{"id":"ref-for-link-type-noreferrer\u2461"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#link-type-noreferrer"},
"0cf3964f": {"dfnID":"0cf3964f","dfnText":"script","external":true,"refSections":[{"refs":[{"id":"ref-for-script"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/scripting.html#script"},
"0fa357c3": {"dfnID":"0fa357c3","dfnText":"length","external":true,"refSections":[{"refs":[{"id":"ref-for-string-length"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://infra.spec.whatwg.org/#string-length"},
"12e9e1d0": {"dfnID":"12e9e1d0","dfnText":"associated document","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-window"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-document-window"},
"218c9455": {"dfnID":"218c9455","dfnText":"username","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-username"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-username"},
"3114a761": {"dfnID":"3114a761","dfnText":"style attribute","external":true,"refSections":[{"refs":[{"id":"ref-for-the-style-attribute"}],"title":"7. Integration with CSS"}],"url":"https://html.spec.whatwg.org/multipage/dom.html#the-style-attribute"},
"347e8fe9": {"dfnID":"347e8fe9","dfnText":"url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-url"},{"id":"ref-for-concept-document-url\u2460"}],"title":"7. Integration with CSS"},{"refs":[{"id":"ref-for-concept-document-url\u2461"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://dom.spec.whatwg.org/#concept-document-url"},
"358f1dbd": {"dfnID":"358f1dbd","dfnText":"referrer","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-referrer"},{"id":"ref-for-concept-request-referrer\u2460"},{"id":"ref-for-concept-request-referrer\u2461"},{"id":"ref-for-concept-request-referrer\u2462"}],"title":"7. Integration with CSS"},{"refs":[{"id":"ref-for-concept-request-referrer\u2463"},{"id":"ref-for-concept-request-referrer\u2464"},{"id":"ref-for-concept-request-referrer\u2465"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-referrer"},
"3a711be7": {"dfnID":"3a711be7","dfnText":"scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-scheme"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-scheme"},
"3ab2ec8b": {"dfnID":"3ab2ec8b","dfnText":"query","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-query"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-query"},
"3b2ff63e": {"dfnID":"3b2ff63e","dfnText":"browsing context (for Document)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-bc"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc"},
"3bdaef91": {"dfnID":"3bdaef91","dfnText":"referer","external":true,"refSections":[{"refs":[{"id":"ref-for-rfc.section.10.1.3"},{"id":"ref-for-rfc.section.10.1.3\u2460"}],"title":"1. Introduction"},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2461"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2462"},{"id":"ref-for-rfc.section.10.1.3\u2463"}],"title":"3.1. \"no-referrer\""},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2464"},{"id":"ref-for-rfc.section.10.1.3\u2465"},{"id":"ref-for-rfc.section.10.1.3\u2466"}],"title":"3.2. \"no-referrer-when-downgrade\""},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2467"},{"id":"ref-for-rfc.section.10.1.3\u2468"},{"id":"ref-for-rfc.section.10.1.3\u2460\u24ea"},{"id":"ref-for-rfc.section.10.1.3\u2460\u2460"}],"title":"3.3. \"same-origin\""},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2460\u2461"},{"id":"ref-for-rfc.section.10.1.3\u2460\u2462"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2460\u2463"},{"id":"ref-for-rfc.section.10.1.3\u2460\u2464"},{"id":"ref-for-rfc.section.10.1.3\u2460\u2465"},{"id":"ref-for-rfc.section.10.1.3\u2460\u2466"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2460\u2467"},{"id":"ref-for-rfc.section.10.1.3\u2460\u2468"},{"id":"ref-for-rfc.section.10.1.3\u2461\u24ea"},{"id":"ref-for-rfc.section.10.1.3\u2461\u2460"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2461\u2461"},{"id":"ref-for-rfc.section.10.1.3\u2461\u2462"},{"id":"ref-for-rfc.section.10.1.3\u2461\u2463"},{"id":"ref-for-rfc.section.10.1.3\u2461\u2464"},{"id":"ref-for-rfc.section.10.1.3\u2461\u2465"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-rfc.section.10.1.3\u2461\u2466"}],"title":"3.8. \"unsafe-url\""}],"url":"https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3"},
"3be1d4ac": {"dfnID":"3be1d4ac","dfnText":"extracting header list values","external":true,"refSections":[{"refs":[{"id":"ref-for-extract-header-list-values"}],"title":"8.1. \n    Parse a referrer policy from a Referrer-Policy header\n  "}],"url":"https://fetch.spec.whatwg.org/#extract-header-list-values"},
"3e12e042": {"dfnID":"3e12e042","dfnText":"environment settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-environment-settings-object"},{"id":"ref-for-environment-settings-object\u2460"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-environment-settings-object\u2461"},{"id":"ref-for-environment-settings-object\u2462"}],"title":"3. Referrer Policies"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"3f2ca4de": {"dfnID":"3f2ca4de","dfnText":"current url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-current-url"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-concept-request-current-url\u2460"},{"id":"ref-for-concept-request-current-url\u2461"}],"title":"3.2. \"no-referrer-when-downgrade\""},{"refs":[{"id":"ref-for-concept-request-current-url\u2462"}],"title":"3.3. \"same-origin\""},{"refs":[{"id":"ref-for-concept-request-current-url\u2463"},{"id":"ref-for-concept-request-current-url\u2464"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-concept-request-current-url\u2465"},{"id":"ref-for-concept-request-current-url\u2466"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-concept-request-current-url\u2467"},{"id":"ref-for-concept-request-current-url\u2468"},{"id":"ref-for-concept-request-current-url\u2460\u24ea"},{"id":"ref-for-concept-request-current-url\u2460\u2460"},{"id":"ref-for-concept-request-current-url\u2460\u2461"},{"id":"ref-for-concept-request-current-url\u2460\u2462"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-current-url"},
"41a7917e": {"dfnID":"41a7917e","dfnText":"alpha","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-B.1"}],"title":"4.1. Delivery via Referrer-Policy header"}],"url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"432147ee": {"dfnID":"432147ee","dfnText":"policy container (for WorkerGlobalScope)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-workerglobalscope-policy-container"}],"title":"6. Integration with HTML"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-policy-container"},
"50093b9d": {"dfnID":"50093b9d","dfnText":"referrerpolicy","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-hyperlink-referrerpolicy"}],"title":"3.9. The empty string"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-hyperlink-referrerpolicy"},
"5216e1a0": {"dfnID":"5216e1a0","dfnText":"node document","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-node-document"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-concept-node-document\u2460"},{"id":"ref-for-concept-node-document\u2461"},{"id":"ref-for-concept-node-document\u2462"},{"id":"ref-for-concept-node-document\u2463"}],"title":"7. Integration with CSS"},{"refs":[{"id":"ref-for-concept-node-document\u2464"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://dom.spec.whatwg.org/#concept-node-document"},
"5442ea33": {"dfnID":"5442ea33","dfnText":"url serializer","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-serializer"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"55213b5b": {"dfnID":"55213b5b","dfnText":"request","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-concept-request\u2460"}],"title":"4. Referrer Policy Delivery"},{"refs":[{"id":"ref-for-concept-request\u2461"},{"id":"ref-for-concept-request\u2462"},{"id":"ref-for-concept-request\u2463"}],"title":"7. Integration with CSS"},{"refs":[{"id":"ref-for-concept-request\u2464"}],"title":"8.2. \n    Set request\u2019s referrer policy on redirect\n  "},{"refs":[{"id":"ref-for-concept-request\u2465"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request"},
"5abc471e": {"dfnID":"5abc471e","dfnText":"navigation","external":true,"refSections":[{"refs":[{"id":"ref-for-navigate"}],"title":"6. Integration with HTML"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#navigate"},
"5d7209e9": {"dfnID":"5d7209e9","dfnText":"Window","external":true,"refSections":[{"refs":[{"id":"ref-for-window"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"60e326a9": {"dfnID":"60e326a9","dfnText":"Document","external":true,"refSections":[{"refs":[{"id":"ref-for-document"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-document\u2460"}],"title":"6. Integration with HTML"}],"url":"https://html.spec.whatwg.org/multipage/dom.html#document"},
"63340982": {"dfnID":"63340982","dfnText":"local scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-local-scheme"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://fetch.spec.whatwg.org/#local-scheme"},
"64b89595": {"dfnID":"64b89595","dfnText":"meta","external":true,"refSections":[{"refs":[{"id":"ref-for-meta"}],"title":"4. Referrer Policy Delivery"},{"refs":[{"id":"ref-for-meta\u2460"},{"id":"ref-for-meta\u2461"}],"title":"4.2. Delivery via meta"},{"refs":[{"id":"ref-for-meta\u2462"}],"title":"11.1. Unknown Policy Values"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#meta"},
"68bf3d31": {"dfnID":"68bf3d31","dfnText":"a","external":true,"refSections":[{"refs":[{"id":"ref-for-the-a-element"},{"id":"ref-for-the-a-element\u2460"},{"id":"ref-for-the-a-element\u2461"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-the-a-element\u2462"},{"id":"ref-for-the-a-element\u2463"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element"},
"6cfa013d": {"dfnID":"6cfa013d","dfnText":"link","external":true,"refSections":[{"refs":[{"id":"ref-for-the-link-element"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element"},
"7393da89": {"dfnID":"7393da89","dfnText":"same origin","external":true,"refSections":[{"refs":[{"id":"ref-for-same-origin"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-same-origin\u2460"},{"id":"ref-for-same-origin\u2461"},{"id":"ref-for-same-origin\u2462"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#same-origin"},
"77b4c09a": {"dfnID":"77b4c09a","dfnText":"assert","external":true,"refSections":[{"refs":[{"id":"ref-for-assert"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://infra.spec.whatwg.org/#assert"},
"7939ecaf": {"dfnID":"7939ecaf","dfnText":"browsing context container","external":true,"refSections":[{"refs":[{"id":"ref-for-browsing-context-container"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-container"},
"83c59a3a": {"dfnID":"83c59a3a","dfnText":"WorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-workerglobalscope"}],"title":"6. Integration with HTML"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"857d5516": {"dfnID":"857d5516","dfnText":"client","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-client"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-concept-request-client\u2460"}],"title":"3. Referrer Policies"},{"refs":[{"id":"ref-for-concept-request-client\u2461"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-client"},
"87fcd40c": {"dfnID":"87fcd40c","dfnText":"iframe","external":true,"refSections":[{"refs":[{"id":"ref-for-the-iframe-element"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element"},
"8a30477b": {"dfnID":"8a30477b","dfnText":"global object","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-settings-object-global"},{"id":"ref-for-concept-settings-object-global\u2460"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"8d526929": {"dfnID":"8d526929","dfnText":"running a worker","external":true,"refSections":[{"refs":[{"id":"ref-for-run-a-worker"}],"title":"6. Integration with HTML"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"},
"959ad97b": {"dfnID":"959ad97b","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-origin"},{"id":"ref-for-concept-url-origin\u2460"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-concept-url-origin\u2461"},{"id":"ref-for-concept-url-origin\u2462"},{"id":"ref-for-concept-url-origin\u2463"},{"id":"ref-for-concept-url-origin\u2464"},{"id":"ref-for-concept-url-origin\u2465"},{"id":"ref-for-concept-url-origin\u2466"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-origin"},
"9c5b5827": {"dfnID":"9c5b5827","dfnText":"an iframe srcdoc document","external":true,"refSections":[{"refs":[{"id":"ref-for-an-iframe-srcdoc-document"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/embedded-content.html#an-iframe-srcdoc-document"},
"9c5d9c4d": {"dfnID":"9c5d9c4d","dfnText":"potentially trustworthy url","external":true,"refSections":[{"refs":[{"id":"ref-for-potentially-trustworthy-url"},{"id":"ref-for-potentially-trustworthy-url\u2460"},{"id":"ref-for-potentially-trustworthy-url\u2461"},{"id":"ref-for-potentially-trustworthy-url\u2462"},{"id":"ref-for-potentially-trustworthy-url\u2463"}],"title":"3.2. \"no-referrer-when-downgrade\""},{"refs":[{"id":"ref-for-potentially-trustworthy-url\u2464"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-potentially-trustworthy-url\u2465"},{"id":"ref-for-potentially-trustworthy-url\u2466"},{"id":"ref-for-potentially-trustworthy-url\u2467"},{"id":"ref-for-potentially-trustworthy-url\u2468"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-potentially-trustworthy-url\u2460\u24ea"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-potentially-trustworthy-url\u2460\u2460"},{"id":"ref-for-potentially-trustworthy-url\u2460\u2461"},{"id":"ref-for-potentially-trustworthy-url\u2460\u2462"},{"id":"ref-for-potentially-trustworthy-url\u2460\u2463"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-potentially-trustworthy-url\u2460\u2464"},{"id":"ref-for-potentially-trustworthy-url\u2460\u2465"},{"id":"ref-for-potentially-trustworthy-url\u2460\u2466"},{"id":"ref-for-potentially-trustworthy-url\u2460\u2467"},{"id":"ref-for-potentially-trustworthy-url\u2460\u2468"},{"id":"ref-for-potentially-trustworthy-url\u2461\u24ea"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url"},
"9ca506a8": {"dfnID":"9ca506a8","dfnText":"css style sheet","external":true,"refSections":[{"refs":[{"id":"ref-for-css-style-sheet"},{"id":"ref-for-css-style-sheet\u2460"}],"title":"7. Integration with CSS"}],"url":"https://drafts.csswg.org/cssom-1/#css-style-sheet"},
"a06e5a78": {"dfnID":"a06e5a78","dfnText":"css declaration block","external":true,"refSections":[{"refs":[{"id":"ref-for-css-declaration-block"},{"id":"ref-for-css-declaration-block\u2460"}],"title":"7. Integration with CSS"}],"url":"https://drafts.csswg.org/cssom-1/#css-declaration-block"},
"a1288f2a": {"dfnID":"a1288f2a","dfnText":"password","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-password"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-password"},
"a1a807e5": {"dfnID":"a1a807e5","dfnText":"area","external":true,"refSections":[{"refs":[{"id":"ref-for-the-area-element"},{"id":"ref-for-the-area-element\u2460"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/image-maps.html#the-area-element"},
"a23d5e9f": {"dfnID":"a23d5e9f","dfnText":"name","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-meta-name"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-name"},
"a33db89a": {"dfnID":"a33db89a","dfnText":"fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-fetch"}],"title":"2. Key Concepts and Terminology"}],"url":"https://fetch.spec.whatwg.org/#concept-fetch"},
"b01b1359": {"dfnID":"b01b1359","dfnText":"opaque origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-origin-opaque"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque"},
"b33787b2": {"dfnID":"b33787b2","dfnText":"policy container","external":true,"refSections":[{"refs":[{"id":"ref-for-policy-container"}],"title":"4.4. Referrer Policy Inheritance"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container"},
"b410a6ef": {"dfnID":"b410a6ef","dfnText":"ascii serialization of an origin","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-serialisation-of-an-origin"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-ascii-serialisation-of-an-origin\u2460"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-ascii-serialisation-of-an-origin\u2461"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-ascii-serialisation-of-an-origin\u2462"}],"title":"3.7. \"strict-origin-when-cross-origin\""}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin"},
"b85ee3be": {"dfnID":"b85ee3be","dfnText":"host","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-host"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-host"},
"bbc31c9d": {"dfnID":"bbc31c9d","dfnText":"location","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-css-style-sheet-location"},{"id":"ref-for-concept-css-style-sheet-location\u2460"},{"id":"ref-for-concept-css-style-sheet-location\u2461"}],"title":"7. Integration with CSS"}],"url":"https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-location"},
"c0868016": {"dfnID":"c0868016","dfnText":"path","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-path"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-path"},
"c62cd7cf": {"dfnID":"c62cd7cf","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-origin"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://dom.spec.whatwg.org/#concept-document-origin"},
"cd03669e": {"dfnID":"cd03669e","dfnText":"referrer policy","external":true,"refSections":[{"refs":[{"id":"ref-for-policy-container-referrer-policy"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-policy-container-referrer-policy\u2460"}],"title":"6. Integration with HTML"},{"refs":[{"id":"ref-for-policy-container-referrer-policy\u2461"},{"id":"ref-for-policy-container-referrer-policy\u2462"},{"id":"ref-for-policy-container-referrer-policy\u2463"}],"title":"7. Integration with CSS"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy"},
"cross-origin-referrer-request": {"dfnID":"cross-origin-referrer-request","dfnText":"cross-origin-referrer request","external":false,"refSections":[{"refs":[{"id":"ref-for-cross-origin-referrer-request"},{"id":"ref-for-cross-origin-referrer-request\u2460"}],"title":"3.3. \"same-origin\""},{"refs":[{"id":"ref-for-cross-origin-referrer-request\u2461"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-cross-origin-referrer-request\u2462"},{"id":"ref-for-cross-origin-referrer-request\u2463"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-cross-origin-referrer-request\u2464"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-cross-origin-referrer-request\u2465"}],"title":"3.8. \"unsafe-url\""}],"url":"#cross-origin-referrer-request"},
"cssstylesheet-referrer-policy": {"dfnID":"cssstylesheet-referrer-policy","dfnText":"referrer policy","external":false,"refSections":[{"refs":[{"id":"ref-for-cssstylesheet-referrer-policy"}],"title":"7. Integration with CSS"}],"url":"#cssstylesheet-referrer-policy"},
"dcffbccd": {"dfnID":"dcffbccd","dfnText":"url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-concept-url\u2460"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url"},
"default-referrer-policy": {"dfnID":"default-referrer-policy","dfnText":"default referrer policy","external":false,"refSections":[{"refs":[{"id":"ref-for-default-referrer-policy"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-default-referrer-policy\u2460"}],"title":"3.9. The empty string"}],"url":"#default-referrer-policy"},
"determine-requests-referrer": {"dfnID":"determine-requests-referrer","dfnText":"8.3. \n    Determine request\u2019s Referrer\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-determine-requests-referrer"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-determine-requests-referrer"}],"title":"5. Integration with Fetch"},{"refs":[{"id":"ref-for-determine-requests-referrer"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"#determine-requests-referrer"},
"dom-referrerpolicy": {"dfnID":"dom-referrerpolicy","dfnText":"\"\"","external":false,"refSections":[],"url":"#dom-referrerpolicy"},
"dom-referrerpolicy-no-referrer": {"dfnID":"dom-referrerpolicy-no-referrer","dfnText":"\"no-referrer\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-no-referrer"},
"dom-referrerpolicy-no-referrer-when-downgrade": {"dfnID":"dom-referrerpolicy-no-referrer-when-downgrade","dfnText":"\"no-referrer-when-downgrade\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-no-referrer-when-downgrade"},
"dom-referrerpolicy-origin": {"dfnID":"dom-referrerpolicy-origin","dfnText":"\"origin\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-origin"},
"dom-referrerpolicy-origin-when-cross-origin": {"dfnID":"dom-referrerpolicy-origin-when-cross-origin","dfnText":"\"origin-when-cross-origin\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-origin-when-cross-origin"},
"dom-referrerpolicy-same-origin": {"dfnID":"dom-referrerpolicy-same-origin","dfnText":"\"same-origin\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-same-origin"},
"dom-referrerpolicy-strict-origin": {"dfnID":"dom-referrerpolicy-strict-origin","dfnText":"\"strict-origin\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-strict-origin"},
"dom-referrerpolicy-strict-origin-when-cross-origin": {"dfnID":"dom-referrerpolicy-strict-origin-when-cross-origin","dfnText":"\"strict-origin-when-cross-origin\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-strict-origin-when-cross-origin"},
"dom-referrerpolicy-unsafe-url": {"dfnID":"dom-referrerpolicy-unsafe-url","dfnText":"\"unsafe-url\"","external":false,"refSections":[],"url":"#dom-referrerpolicy-unsafe-url"},
"ea4eef27": {"dfnID":"ea4eef27","dfnText":"referrer policy attribute","external":true,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-attribute"}],"title":"4.3. Delivery\n    via a referrerpolicy content attribute"}],"url":"https://html.spec.whatwg.org/multipage/infrastructure.html#referrer-policy-attribute"},
"eab73120": {"dfnID":"eab73120","dfnText":"owner node (for CSSStyleDeclaration)","external":true,"refSections":[{"refs":[{"id":"ref-for-cssstyledeclaration-owner-node"},{"id":"ref-for-cssstyledeclaration-owner-node\u2460"},{"id":"ref-for-cssstyledeclaration-owner-node\u2461"}],"title":"7. Integration with CSS"}],"url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node"},
"ed948033": {"dfnID":"ed948033","dfnText":"fragment","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-fragment"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-fragment"},
"ee7bba09": {"dfnID":"ee7bba09","dfnText":"response","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response"}],"title":"8.1. \n    Parse a referrer policy from a Referrer-Policy header\n  "},{"refs":[{"id":"ref-for-concept-response\u2460"}],"title":"8.2. \n    Set request\u2019s referrer policy on redirect\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response"},
"enumdef-referrerpolicy": {"dfnID":"enumdef-referrerpolicy","dfnText":"ReferrerPolicy","external":false,"refSections":[],"url":"#enumdef-referrerpolicy"},
"f0811ff8": {"dfnID":"f0811ff8","dfnText":"img","external":true,"refSections":[{"refs":[{"id":"ref-for-the-img-element"}],"title":"4. Referrer Policy Delivery"}],"url":"https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element"},
"f588bce5": {"dfnID":"f588bce5","dfnText":"referrer","external":true,"refSections":[{"refs":[{"id":"ref-for-meta-referrer"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-meta-referrer\u2460"}],"title":"4. Referrer Policy Delivery"},{"refs":[{"id":"ref-for-meta-referrer\u2461"}],"title":"4.2. Delivery via meta"},{"refs":[{"id":"ref-for-meta-referrer\u2462"}],"title":"11.1. Unknown Policy Values"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#meta-referrer"},
"f7b00a8b": {"dfnID":"f7b00a8b","dfnText":"header list","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-header-list"}],"title":"8.1. \n    Parse a referrer policy from a Referrer-Policy header\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"f9da6f1f": {"dfnID":"f9da6f1f","dfnText":"Request","external":true,"refSections":[{"refs":[{"id":"ref-for-request"},{"id":"ref-for-request\u2460"}],"title":"2. Key Concepts and Terminology"}],"url":"https://fetch.spec.whatwg.org/#request"},
"fa5ee9c5": {"dfnID":"fa5ee9c5","dfnText":"creation url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-environment-creation-url"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"},
"faf954d6": {"dfnID":"faf954d6","dfnText":"browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-browsing-context"}],"title":"4.1. Delivery via Referrer-Policy header"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"},
"fefe9144": {"dfnID":"fefe9144","dfnText":"presentational hints","external":true,"refSections":[{"refs":[{"id":"ref-for-presentational-hints"}],"title":"7. Integration with CSS"}],"url":"https://html.spec.whatwg.org/multipage/rendering.html#presentational-hints"},
"grammardef-extension-token": {"dfnID":"grammardef-extension-token","dfnText":"extension-token","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-extension-token"},{"id":"ref-for-grammardef-extension-token\u2460"}],"title":"4.1. Delivery via Referrer-Policy header"}],"url":"#grammardef-extension-token"},
"grammardef-policy-token": {"dfnID":"grammardef-policy-token","dfnText":"policy-token","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-policy-token"}],"title":"4.1. Delivery via Referrer-Policy header"}],"url":"#grammardef-policy-token"},
"origin-only-flag": {"dfnID":"origin-only-flag","dfnText":"origin-only flag","external":false,"refSections":[{"refs":[{"id":"ref-for-origin-only-flag"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-origin-only-flag\u2460"}],"title":"8.4. \n    Strip url for use as a referrer\n  "}],"url":"#origin-only-flag"},
"referrer-policy": {"dfnID":"referrer-policy","dfnText":"referrer policy","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy"},{"id":"ref-for-referrer-policy\u2460"},{"id":"ref-for-referrer-policy\u2461"},{"id":"ref-for-referrer-policy\u2462"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-referrer-policy\u2463"}],"title":"3. Referrer Policies"},{"refs":[{"id":"ref-for-referrer-policy\u2464"},{"id":"ref-for-referrer-policy\u2465"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-referrer-policy\u2466"}],"title":"4.2. Delivery via meta"},{"refs":[{"id":"ref-for-referrer-policy\u2467"}],"title":"4.4. Referrer Policy Inheritance"},{"refs":[{"id":"ref-for-referrer-policy\u2468"}],"title":"6. Integration with HTML"},{"refs":[{"id":"ref-for-referrer-policy\u2460\u24ea"},{"id":"ref-for-referrer-policy\u2460\u2460"}],"title":"8.1. \n    Parse a referrer policy from a Referrer-Policy header\n  "},{"refs":[{"id":"ref-for-referrer-policy\u2460\u2461"}],"title":"9.1. User Controls"},{"refs":[{"id":"ref-for-referrer-policy\u2460\u2462"}],"title":"10.1. Information Leakage"}],"url":"#referrer-policy"},
"referrer-policy-empty-string": {"dfnID":"referrer-policy-empty-string","dfnText":"3.9. The empty string","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-empty-string"}],"title":"3.9. The empty string"}],"url":"#referrer-policy-empty-string"},
"referrer-policy-header-dfn": {"dfnID":"referrer-policy-header-dfn","dfnText":"Referrer-Policy","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-header-dfn"}],"title":"8.1. \n    Parse a referrer policy from a Referrer-Policy header\n  "}],"url":"#referrer-policy-header-dfn"},
"referrer-policy-no-referrer": {"dfnID":"referrer-policy-no-referrer","dfnText":"3.1. \"no-referrer\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-no-referrer"},{"id":"ref-for-referrer-policy-no-referrer"},{"id":"ref-for-referrer-policy-no-referrer\u2460"}],"title":"3.1. \"no-referrer\""},{"refs":[{"id":"ref-for-referrer-policy-no-referrer\u2461"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-referrer-policy-no-referrer\u2462"}],"title":"10.1. Information Leakage"},{"refs":[{"id":"ref-for-referrer-policy-no-referrer\u2463"}],"title":"10.2. Downgrade to less strict policies"}],"url":"#referrer-policy-no-referrer"},
"referrer-policy-no-referrer-when-downgrade": {"dfnID":"referrer-policy-no-referrer-when-downgrade","dfnText":"3.2. \"no-referrer-when-downgrade\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-no-referrer-when-downgrade"},{"id":"ref-for-referrer-policy-no-referrer-when-downgrade"},{"id":"ref-for-referrer-policy-no-referrer-when-downgrade\u2460"}],"title":"3.2. \"no-referrer-when-downgrade\""},{"refs":[{"id":"ref-for-referrer-policy-no-referrer-when-downgrade\u2461"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-referrer-policy-no-referrer-when-downgrade\u2462"}],"title":"10.2. Downgrade to less strict policies"}],"url":"#referrer-policy-no-referrer-when-downgrade"},
"referrer-policy-origin": {"dfnID":"referrer-policy-origin","dfnText":"3.4. \"origin\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-origin"},{"id":"ref-for-referrer-policy-origin"},{"id":"ref-for-referrer-policy-origin\u2460"},{"id":"ref-for-referrer-policy-origin\u2461"},{"id":"ref-for-referrer-policy-origin\u2462"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-referrer-policy-origin\u2463"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-referrer-policy-origin\u2464"}],"title":"10.1. Information Leakage"},{"refs":[{"id":"ref-for-referrer-policy-origin\u2465"}],"title":"10.2. Downgrade to less strict policies"},{"refs":[{"id":"ref-for-referrer-policy-origin\u2466"},{"id":"ref-for-referrer-policy-origin\u2467"}],"title":"11.1. Unknown Policy Values"}],"url":"#referrer-policy-origin"},
"referrer-policy-origin-when-cross-origin": {"dfnID":"referrer-policy-origin-when-cross-origin","dfnText":"3.6. \"origin-when-cross-origin\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-origin-when-cross-origin"},{"id":"ref-for-referrer-policy-origin-when-cross-origin"},{"id":"ref-for-referrer-policy-origin-when-cross-origin\u2460"},{"id":"ref-for-referrer-policy-origin-when-cross-origin\u2461"},{"id":"ref-for-referrer-policy-origin-when-cross-origin\u2462"},{"id":"ref-for-referrer-policy-origin-when-cross-origin\u2463"},{"id":"ref-for-referrer-policy-origin-when-cross-origin\u2464"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-referrer-policy-origin-when-cross-origin\u2465"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-referrer-policy-origin-when-cross-origin\u2466"}],"title":"10.1. Information Leakage"}],"url":"#referrer-policy-origin-when-cross-origin"},
"referrer-policy-same-origin": {"dfnID":"referrer-policy-same-origin","dfnText":"3.3. \"same-origin\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-same-origin"},{"id":"ref-for-referrer-policy-same-origin"},{"id":"ref-for-referrer-policy-same-origin\u2460"},{"id":"ref-for-referrer-policy-same-origin\u2461"}],"title":"3.3. \"same-origin\""},{"refs":[{"id":"ref-for-referrer-policy-same-origin\u2462"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-referrer-policy-same-origin\u2463"}],"title":"10.1. Information Leakage"}],"url":"#referrer-policy-same-origin"},
"referrer-policy-strict-origin": {"dfnID":"referrer-policy-strict-origin","dfnText":"3.5. \"strict-origin\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-strict-origin"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-referrer-policy-strict-origin"},{"id":"ref-for-referrer-policy-strict-origin\u2460"},{"id":"ref-for-referrer-policy-strict-origin\u2461"},{"id":"ref-for-referrer-policy-strict-origin\u2462"},{"id":"ref-for-referrer-policy-strict-origin\u2463"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-referrer-policy-strict-origin\u2464"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-referrer-policy-strict-origin\u2465"}],"title":"10.1. Information Leakage"}],"url":"#referrer-policy-strict-origin"},
"referrer-policy-strict-origin-when-cross-origin": {"dfnID":"referrer-policy-strict-origin-when-cross-origin","dfnText":"3.7. \"strict-origin-when-cross-origin\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin"}],"title":"3. Referrer Policies"},{"refs":[{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin\u2460"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin"},{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin\u2461"},{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin\u2462"},{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin\u2463"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin\u2464"}],"title":"3.9. The empty string"},{"refs":[{"id":"ref-for-referrer-policy-strict-origin-when-cross-origin\u2465"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"#referrer-policy-strict-origin-when-cross-origin"},
"referrer-policy-unsafe-url": {"dfnID":"referrer-policy-unsafe-url","dfnText":"3.8. \"unsafe-url\"","external":false,"refSections":[{"refs":[{"id":"ref-for-referrer-policy-unsafe-url"},{"id":"ref-for-referrer-policy-unsafe-url"},{"id":"ref-for-referrer-policy-unsafe-url\u2460"}],"title":"3.8. \"unsafe-url\""},{"refs":[{"id":"ref-for-referrer-policy-unsafe-url\u2461"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "},{"refs":[{"id":"ref-for-referrer-policy-unsafe-url\u2462"}],"title":"10.1. Information Leakage"},{"refs":[{"id":"ref-for-referrer-policy-unsafe-url\u2463"}],"title":"10.2. Downgrade to less strict policies"},{"refs":[{"id":"ref-for-referrer-policy-unsafe-url\u2464"},{"id":"ref-for-referrer-policy-unsafe-url\u2465"},{"id":"ref-for-referrer-policy-unsafe-url\u2466"},{"id":"ref-for-referrer-policy-unsafe-url\u2467"}],"title":"11.1. Unknown Policy Values"}],"url":"#referrer-policy-unsafe-url"},
"referrerurl": {"dfnID":"referrerurl","dfnText":"referrerURL","external":false,"refSections":[{"refs":[{"id":"ref-for-referrerurl"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-referrerurl\u2460"},{"id":"ref-for-referrerurl\u2461"},{"id":"ref-for-referrerurl\u2462"},{"id":"ref-for-referrerurl\u2463"}],"title":"3.2. \"no-referrer-when-downgrade\""},{"refs":[{"id":"ref-for-referrerurl\u2464"},{"id":"ref-for-referrerurl\u2465"}],"title":"3.3. \"same-origin\""},{"refs":[{"id":"ref-for-referrerurl\u2466"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-referrerurl\u2467"},{"id":"ref-for-referrerurl\u2468"},{"id":"ref-for-referrerurl\u2460\u24ea"},{"id":"ref-for-referrerurl\u2460\u2460"}],"title":"3.5. \"strict-origin\""},{"refs":[{"id":"ref-for-referrerurl\u2460\u2461"},{"id":"ref-for-referrerurl\u2460\u2462"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-referrerurl\u2460\u2463"},{"id":"ref-for-referrerurl\u2460\u2464"},{"id":"ref-for-referrerurl\u2460\u2465"},{"id":"ref-for-referrerurl\u2460\u2466"},{"id":"ref-for-referrerurl\u2460\u2467"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-referrerurl\u2460\u2468"}],"title":"3.8. \"unsafe-url\""},{"refs":[{"id":"ref-for-referrerurl\u2461\u24ea"},{"id":"ref-for-referrerurl\u2461\u2460"},{"id":"ref-for-referrerurl\u2461\u2461"},{"id":"ref-for-referrerurl\u2461\u2462"},{"id":"ref-for-referrerurl\u2461\u2463"},{"id":"ref-for-referrerurl\u2461\u2464"},{"id":"ref-for-referrerurl\u2461\u2465"},{"id":"ref-for-referrerurl\u2461\u2466"},{"id":"ref-for-referrerurl\u2461\u2467"},{"id":"ref-for-referrerurl\u2461\u2468"},{"id":"ref-for-referrerurl\u2462\u24ea"},{"id":"ref-for-referrerurl\u2462\u2460"},{"id":"ref-for-referrerurl\u2462\u2461"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"#referrerurl"},
"same-origin-referrer-request": {"dfnID":"same-origin-referrer-request","dfnText":"same-origin-referrer request","external":false,"refSections":[{"refs":[{"id":"ref-for-same-origin-referrer-request"}],"title":"2. Key Concepts and Terminology"},{"refs":[{"id":"ref-for-same-origin-referrer-request\u2460"}],"title":"3.3. \"same-origin\""},{"refs":[{"id":"ref-for-same-origin-referrer-request\u2461"}],"title":"3.4. \"origin\""},{"refs":[{"id":"ref-for-same-origin-referrer-request\u2462"}],"title":"3.6. \"origin-when-cross-origin\""},{"refs":[{"id":"ref-for-same-origin-referrer-request\u2463"}],"title":"3.7. \"strict-origin-when-cross-origin\""},{"refs":[{"id":"ref-for-same-origin-referrer-request\u2464"}],"title":"3.8. \"unsafe-url\""},{"refs":[{"id":"ref-for-same-origin-referrer-request\u2465"}],"title":"8.3. \n    Determine request\u2019s Referrer\n  "}],"url":"#same-origin-referrer-request"},
"set-requests-referrer-policy-on-redirect": {"dfnID":"set-requests-referrer-policy-on-redirect","dfnText":"8.2. \n    Set request\u2019s referrer policy on redirect\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-set-requests-referrer-policy-on-redirect"}],"title":"5. Integration with Fetch"},{"refs":[{"id":"ref-for-set-requests-referrer-policy-on-redirect"}],"title":"8.2. \n    Set request\u2019s referrer policy on redirect\n  "}],"url":"#set-requests-referrer-policy-on-redirect"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-position-annos */
"use strict";
{
function repositionAnnoPanels(){
    const panels = [...document.querySelectorAll("[data-anno-for]")];
    hydratePanels(panels);
    let vSoFar = 0;
    for(const panel of panels.sort(cmpTops)) {
        if(panel.top < vSoFar) {
            panel.top = vSoFar;
            panel.style.top = vSoFar + "px";
        }
        vSoFar = panel.top + panel.height + 15;
    }
}
function hydratePanels(panels) {
    const main = document.querySelector("main");
    let mainRect;
    if(main) mainRect = main.getBoundingClientRect();
    // First display them all, if they're not already visible.
    for(const panel of panels) {
        panel.classList.remove("unpositioned");
    }
    // Measure them all
    for(const panel of panels) {
        const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
        if(!dfn) {
            console.log("Can't find the annotation panel target:", panel);
            continue;
        }
        panel.dfn = dfn;
        panel.top = window.scrollY + dfn.getBoundingClientRect().top;
        let panelRect = panel.getBoundingClientRect();
        panel.height = panelRect.height;
        if(main) {
            panel.overlappingMain = panelRect.left < mainRect.right;
        } else {
            panel.overlappingMain = false;
        }
    }
    // And finally position them
    for(const panel of panels) {
        const dfn = panel.dfn;
        if(!dfn) continue;
        panel.style.top = panel.top + "px";
        panel.classList.toggle("overlapping-main", panel.overlappingMain);
    }
}

function cmpTops(a,b) {
    return a.top - b.top;
}

window.addEventListener("load", repositionAnnoPanels);
window.addEventListener("resize", repositionAnnoPanels);
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#cross-origin-referrer-request": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"cross-origin-referrer request","type":"dfn","url":"#cross-origin-referrer-request"},
"#cssstylesheet-referrer-policy": {"export":true,"for_":["CSSStyleSheet"],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"referrer policy","type":"dfn","url":"#cssstylesheet-referrer-policy"},
"#default-referrer-policy": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"default referrer policy","type":"dfn","url":"#default-referrer-policy"},
"#grammardef-extension-token": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"extension-token","type":"grammar","url":"#grammardef-extension-token"},
"#grammardef-policy-token": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"policy-token","type":"grammar","url":"#grammardef-policy-token"},
"#origin-only-flag": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"origin-only flag","type":"dfn","url":"#origin-only-flag"},
"#referrer-policy": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"referrer policy","type":"dfn","url":"#referrer-policy"},
"#referrer-policy-header-dfn": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"referrer-policy","type":"dfn","url":"#referrer-policy-header-dfn"},
"#referrer-policy-no-referrer": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"no-referrer\"","type":"dfn","url":"#referrer-policy-no-referrer"},
"#referrer-policy-no-referrer-when-downgrade": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"no-referrer-when-downgrade\"","type":"dfn","url":"#referrer-policy-no-referrer-when-downgrade"},
"#referrer-policy-origin": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"origin\"","type":"dfn","url":"#referrer-policy-origin"},
"#referrer-policy-origin-when-cross-origin": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"origin-when-cross-origin\"","type":"dfn","url":"#referrer-policy-origin-when-cross-origin"},
"#referrer-policy-same-origin": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"same-origin\"","type":"dfn","url":"#referrer-policy-same-origin"},
"#referrer-policy-strict-origin": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"strict-origin\"","type":"dfn","url":"#referrer-policy-strict-origin"},
"#referrer-policy-strict-origin-when-cross-origin": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"strict-origin-when-cross-origin\"","type":"dfn","url":"#referrer-policy-strict-origin-when-cross-origin"},
"#referrer-policy-unsafe-url": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"\"unsafe-url\"","type":"dfn","url":"#referrer-policy-unsafe-url"},
"#referrerurl": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"referrerurl","type":"dfn","url":"#referrerurl"},
"#same-origin-referrer-request": {"export":true,"for_":[],"level":"","normative":true,"shortname":"referrer-policy","spec":"referrer-policy","status":"local","text":"same-origin-referrer request","type":"dfn","url":"#same-origin-referrer-request"},
"https://dom.spec.whatwg.org/#concept-document-origin": {"export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"origin","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-document-origin"},
"https://dom.spec.whatwg.org/#concept-document-url": {"export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"url","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-document-url"},
"https://dom.spec.whatwg.org/#concept-node-document": {"export":true,"for_":["Node"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"node document","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-node-document"},
"https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-location": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"anchor-block","text":"location","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-location"},
"https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-owner-node": {"export":true,"for_":["CSSStyleSheet"],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"anchor-block","text":"owner node","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#concept-css-style-sheet-owner-node"},
"https://drafts.csswg.org/cssom-1/#css-declaration-block": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"anchor-block","text":"css declaration block","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#css-declaration-block"},
"https://drafts.csswg.org/cssom-1/#css-style-sheet": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"css style sheet","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#css-style-sheet"},
"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node": {"export":true,"for_":["CSSStyleDeclaration"],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"anchor-block","text":"owner node","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node"},
"https://fetch.spec.whatwg.org/#concept-fetch": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"fetch","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-fetch"},
"https://fetch.spec.whatwg.org/#concept-request": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"request","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request"},
"https://fetch.spec.whatwg.org/#concept-request-client": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"client","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-client"},
"https://fetch.spec.whatwg.org/#concept-request-current-url": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"current url","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-current-url"},
"https://fetch.spec.whatwg.org/#concept-request-referrer": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"referrer","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-referrer"},
"https://fetch.spec.whatwg.org/#concept-request-referrer-policy": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"referrer policy","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-referrer-policy"},
"https://fetch.spec.whatwg.org/#concept-response": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"response","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response"},
"https://fetch.spec.whatwg.org/#concept-response-header-list": {"export":true,"for_":["response"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"header list","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"https://fetch.spec.whatwg.org/#extract-header-list-values": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"extracting header list values","type":"dfn","url":"https://fetch.spec.whatwg.org/#extract-header-list-values"},
"https://fetch.spec.whatwg.org/#local-scheme": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"local scheme","type":"dfn","url":"https://fetch.spec.whatwg.org/#local-scheme"},
"https://fetch.spec.whatwg.org/#request": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"Request","type":"interface","url":"https://fetch.spec.whatwg.org/#request"},
"https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"ascii serialization of an origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin"},
"https://html.spec.whatwg.org/multipage/browsers.html#browsing-context": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"browsing context","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#browsing-context"},
"https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-container": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"browsing context container","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-container"},
"https://html.spec.whatwg.org/multipage/browsers.html#concept-document-window": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"associated document","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-document-window"},
"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin"},
"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"opaque origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque"},
"https://html.spec.whatwg.org/multipage/browsers.html#navigate": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"navigation","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#navigate"},
"https://html.spec.whatwg.org/multipage/browsers.html#policy-container": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"policy container","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container"},
"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy": {"export":true,"for_":["policy container"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"referrer policy","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-referrer-policy"},
"https://html.spec.whatwg.org/multipage/browsers.html#same-origin": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"same origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#same-origin"},
"https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc": {"export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"browsing context","type":"dfn","url":"https://html.spec.whatwg.org/multipage/document-sequences.html#concept-document-bc"},
"https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container": {"export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"policy container","type":"dfn","url":"https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container"},
"https://html.spec.whatwg.org/multipage/dom.html#document": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"Document","type":"interface","url":"https://html.spec.whatwg.org/multipage/dom.html#document"},
"https://html.spec.whatwg.org/multipage/dom.html#the-style-attribute": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"style attribute","type":"dfn","url":"https://html.spec.whatwg.org/multipage/dom.html#the-style-attribute"},
"https://html.spec.whatwg.org/multipage/embedded-content.html#an-iframe-srcdoc-document": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"an iframe srcdoc document","type":"dfn","url":"https://html.spec.whatwg.org/multipage/embedded-content.html#an-iframe-srcdoc-document"},
"https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"img","type":"element","url":"https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"iframe","type":"element","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element"},
"https://html.spec.whatwg.org/multipage/image-maps.html#the-area-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"area","type":"element","url":"https://html.spec.whatwg.org/multipage/image-maps.html#the-area-element"},
"https://html.spec.whatwg.org/multipage/infrastructure.html#referrer-policy-attribute": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"referrer policy attribute","type":"dfn","url":"https://html.spec.whatwg.org/multipage/infrastructure.html#referrer-policy-attribute"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"Window","type":"interface","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"https://html.spec.whatwg.org/multipage/rendering.html#presentational-hints": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"presentational hints","type":"dfn","url":"https://html.spec.whatwg.org/multipage/rendering.html#presentational-hints"},
"https://html.spec.whatwg.org/multipage/scripting.html#script": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"script","type":"element","url":"https://html.spec.whatwg.org/multipage/scripting.html#script"},
"https://html.spec.whatwg.org/multipage/semantics.html#attr-hyperlink-referrerpolicy": {"export":true,"for_":["a"],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"referrerpolicy","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-hyperlink-referrerpolicy"},
"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-name": {"export":true,"for_":["meta"],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"name","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-name"},
"https://html.spec.whatwg.org/multipage/semantics.html#link-type-noreferrer": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"noreferrer","type":"dfn","url":"https://html.spec.whatwg.org/multipage/semantics.html#link-type-noreferrer"},
"https://html.spec.whatwg.org/multipage/semantics.html#meta": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"meta","type":"element","url":"https://html.spec.whatwg.org/multipage/semantics.html#meta"},
"https://html.spec.whatwg.org/multipage/semantics.html#meta-referrer": {"export":true,"for_":["meta"],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"referrer","type":"dfn","url":"https://html.spec.whatwg.org/multipage/semantics.html#meta-referrer"},
"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"link","type":"element","url":"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element"},
"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"a","type":"element","url":"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url": {"export":true,"for_":["environment"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"creation url","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global": {"export":true,"for_":["environment settings object"],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"environment settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-policy-container": {"export":true,"for_":["WorkerGlobalScope"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"policy container","type":"dfn","url":"https://html.spec.whatwg.org/multipage/workers.html#concept-workerglobalscope-policy-container"},
"https://html.spec.whatwg.org/multipage/workers.html#run-a-worker": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"running a worker","type":"dfn","url":"https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"},
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"WorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc9110","spec":"rfc9110","status":"anchor-block","text":"referer","type":"dfn","url":"https://httpwg.org/specs/rfc9110.html#rfc.section.10.1.3"},
"https://infra.spec.whatwg.org/#assert": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"assert","type":"dfn","url":"https://infra.spec.whatwg.org/#assert"},
"https://infra.spec.whatwg.org/#string-length": {"export":true,"for_":["string","JavaScript string","scalar value string"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"length","type":"dfn","url":"https://infra.spec.whatwg.org/#string-length"},
"https://tools.ietf.org/html/rfc5234#appendix-B.1": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc5234","spec":"rfc5234","status":"anchor-block","text":"alpha","type":"grammar","url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"https://url.spec.whatwg.org/#concept-url": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"url","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url"},
"https://url.spec.whatwg.org/#concept-url-fragment": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"fragment","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-fragment"},
"https://url.spec.whatwg.org/#concept-url-host": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"host","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-host"},
"https://url.spec.whatwg.org/#concept-url-origin": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"origin","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-origin"},
"https://url.spec.whatwg.org/#concept-url-password": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"password","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-password"},
"https://url.spec.whatwg.org/#concept-url-path": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"path","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-path"},
"https://url.spec.whatwg.org/#concept-url-query": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"query","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-query"},
"https://url.spec.whatwg.org/#concept-url-scheme": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"scheme","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-scheme"},
"https://url.spec.whatwg.org/#concept-url-serializer": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"url serializer","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"https://url.spec.whatwg.org/#concept-url-username": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"username","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-username"},
"https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"secure-contexts","spec":"secure-contexts","status":"current","text":"potentially trustworthy url","type":"dfn","url":"https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-url"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.text != linkText) {
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.text)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>